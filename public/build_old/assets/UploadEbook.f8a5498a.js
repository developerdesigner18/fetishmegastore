import{i as Te,r as u,j as i,a as e,H as De,L as Ee}from"./app.19cefab4.js";import{A as Fe}from"./AuthenticatedLayout.8df4bd0c.js";import{_ as a}from"./Translate.dc83ae5b.js";import{Q as v}from"./react-toastify.esm.594ac60b.js";import{I as c}from"./InputLabel.dc3a6c34.js";import{I as p}from"./InputError.6c9d0edc.js";import{T as f}from"./TextInput.578de99c.js";import{T as de}from"./Textarea.5f22d4b5.js";import{P as Pe}from"./PrimaryButton.13d0606e.js";import{S as k}from"./sweetalert2.esm.all.08ba7c87.js";import{C as j}from"./Checkbox.d970ee1b.js";import Ae from"./AccountNavi.0feb8781.js";import{c as je}from"./index.esm.a625d265.js";import{S}from"./Front.ff2cd402.js";import{S as ze}from"./index.4654b5c3.js";import"./index.6ccb561e.js";import"./index.7638ddab.js";import"./iconBase.c21c0bbc.js";import"./index.44fa3034.js";import"./react-cookie-consent.esm.6827f7e8.js";import"./transition.96a9edea.js";import"./Modal.a58146e0.js";import"./index.e7e076b2.js";import"./index.esm.3513504a.js";function nt({ebook:t,ogValue:l,categories:ce,models:oe,tags:me,fileNames:_e,supportedLocales:w,selectedCategoryIds:z,selectedModelIds:L,selectedTagNames:O}){var G,K,J,Q,W,X,Z,V,ee,te,se,ae,le,re,ie,ne;const{data:d,setData:h,post:q,processing:U,errors:m,progress:Le}=Te({title_en:((G=l==null?void 0:l.title)==null?void 0:G.en)||"",title_lang:(l==null?void 0:l.title_lang)||"",title_lang_val:((K=l==null?void 0:l.title)==null?void 0:K[l==null?void 0:l.title_lang])||"",description_en:((J=l==null?void 0:l.description)==null?void 0:J.en)||"",description_lang:(l==null?void 0:l.description_lang)||"",description_lang_val:((Q=l==null?void 0:l.description)==null?void 0:Q[l==null?void 0:l.description_lang])||"",tag:t.tags&&typeof t.tags=="string"&&t.tags?t.tags.split(","):O||[],category_id:t.category_id&&typeof t.category_id=="string"&&t.category_id?t.category_id.split(",").map(Number):z||[],model_id:t.model_id&&typeof t.model_id=="string"&&t.model_id?t.model_id.split(",").map(Number):L||[],price:t.price||"",free_for_subs:t.free_for_subs||"no",is_from_ftp:t.is_from_ftp===1,thumbnail:"",ebook_file_input:null,ebook_file:t.ebook_file||"",is_terms:typeof t.is_terms=="boolean"?t.is_terms:!1,is_agreement:typeof t.is_agreement=="boolean"?t.is_agreement:!1,is_rules:typeof t.is_rules=="boolean"?t.is_rules:!1,seo:{h2:((W=t.seoDetails)==null?void 0:W.h2)||null,keyword:((X=t.seoDetails)==null?void 0:X.keyword)||null,meta_keyword:((Z=t.seoDetails)==null?void 0:Z.meta_keyword)||null,desc:((V=t.seoDetails)==null?void 0:V.desc)||null,og_title:((ee=t.seoDetails)==null?void 0:ee.og_title)||null,og_desc:((te=t.seoDetails)==null?void 0:te.og_desc)||null,meta_robot:((se=t.seoDetails)==null?void 0:se.meta_robot)||null,cust_url:((ae=t.seoDetails)==null?void 0:ae.cust_url)||null,og_image_url:((le=t.seoDetails)==null?void 0:le.og_image_url)||null,json_id:((re=t.seoDetails)==null?void 0:re.json_id)||null}}),[g,T]=u.exports.useState(null),[N,C]=u.exports.useState([]),[Oe,x]=u.exports.useState(!1),[he,D]=u.exports.useState(0),[y,M]=u.exports.useState(d.is_from_ftp),[R,E]=u.exports.useState(t.thumbnail?`/${t.thumbnail}`:null),[F,$]=u.exports.useState(t.category_id&&typeof t.category_id=="string"?t.category_id.split(",").map(Number):z||[]),[P,B]=u.exports.useState(t.model_id&&typeof t.model_id=="string"?t.model_id.split(",").map(Number):L||[]),[A,I]=u.exports.useState(t.tags&&typeof t.tags=="string"&&t.tags!==""?t.tags.split(","):O||[]),ue=()=>{M(s=>{const r=!s;return h("is_from_ftp",r),r})},fe=s=>{const r=s.target.files[0];if(h("thumbnail",r),r){const n=new FileReader;n.onloadend=()=>{E(n.result)},n.readAsDataURL(r)}else E(null)},pe=s=>{const r=s.target.files[0];T(r),h("ebook_file_input",r)},ge=s=>{T(null),h("ebook_file",s)},ve=s=>{I(s)},be=s=>{$(s)},ye=s=>{B(s)},_=s=>{const{name:r,type:n,checked:o,value:b}=s.target;if(r.startsWith("seo.")){const Se=r.split(".")[1];h("seo",{...d.seo,[Se]:n==="checkbox"?o:b})}else h(r,n==="checkbox"?o:b)},Ne=s=>{const r=s.target.value,n=t.title||{};h(o=>({...o,title_lang:r,title_lang_val:n[r]||""}))},we=s=>{const r=s.target.value,n=t.description||{};h(o=>({...o,description_lang:r,description_lang_val:n[r]||""}))};u.exports.useEffect(()=>{t&&(h(s=>{var r,n,o,b;return{...s,title_en:((r=l==null?void 0:l.title)==null?void 0:r.en)||"",title_lang:(l==null?void 0:l.title_lang)||"",title_lang_val:((n=l==null?void 0:l.title)==null?void 0:n[l==null?void 0:l.title_lang])||"",description_en:((o=l==null?void 0:l.description)==null?void 0:o.en)||"",description_lang:(l==null?void 0:l.description_lang)||"",description_lang_val:((b=l==null?void 0:l.description)==null?void 0:b[l==null?void 0:l.description_lang])||"",price:t.price||"",free_for_subs:t.free_for_subs||"no",ebook_file:t.ebook_file||"",is_terms:typeof t.is_terms=="boolean"?t.is_terms:!1,is_agreement:typeof t.is_agreement=="boolean"?t.is_agreement:!1,is_rules:typeof t.is_rules=="boolean"?t.is_rules:!1,seo:t.seoDetails||{}}}),M(t.is_from_ftp===1),$(t.category_id&&typeof t.category_id=="string"?t.category_id.split(",").map(Number):[]),B(t.model_id&&typeof t.model_id=="string"?t.model_id.split(",").map(Number):[]),I(t.tags&&typeof t.tags=="string"?t.tags.split(","):[]),E(t.thumbnail?`/${t.thumbnail}`:null),T(null))},[t,l]),u.exports.useEffect(()=>{h("category_id",F)},[F]),u.exports.useEffect(()=>{h("model_id",P)},[P]),u.exports.useEffect(()=>{h("tag",A)},[A]),u.exports.useEffect(()=>{Object.keys(m).length&&Object.keys(m).forEach(s=>{v.error(m[s])})},[m]),u.exports.useEffect(()=>{N.length>0&&g&&xe()},[N,g]);const Ce=()=>{if(!g){v.error(a("Please select an ebook file to upload."));return}C([]);let s=1024*1024*8,r=Math.ceil(g.size/s);for(let n=0;n<r;n++)C(o=>[...o,g.slice(n*s,Math.min(n*s+s,g.size),g.type)])},xe=()=>{x(!0);const s=new FormData;s.append("media_type","ebook"),s.append("is_last",N.length===1),s.append("ebook",t.id||0),s.set("file",N[0],`${g.name}.part`),axios.post(route("ebook.uploadChunks"),s,{onUploadProgress:r=>{D(he+r.loaded)}}).then(function(r){N.length<=1&&(C([]),D(0),h("ebook_file",r.data.result),t.id===null?H():Y());let n=[...N];n.splice(0,1),C(n)}).catch(function(r){var n,o;D(0),v.error(((o=(n=r.response)==null?void 0:n.data)==null?void 0:o.message)||a("An error occurred during chunk upload."))}).then(function(){x(!1)})},H=()=>{k.fire({title:a("Are you sure?"),text:a("Do you want to save this ebook?"),icon:"warning",showCancelButton:!0,confirmButtonText:a("Yes, save it!"),cancelButtonText:a("No, cancel")}).then(s=>{s.isConfirmed?(q(route("ebook.saveEbook"),{forceFormData:!0}),k.fire(a("Saved!"),a("Your ebook has been saved."),"success")):s.dismiss===k.DismissReason.cancel&&k.fire(a("Cancelled"),a("Your ebook has not been saved"),"error")})},Y=()=>{q(route("ebook.update",{ebook:t.id}),{forceFormData:!0})},ke=s=>{if(s.preventDefault(),!d.is_terms){v.error(a("Please agree to terms and conditions"));return}if(!d.is_agreement){v.error(a("Please agree to the agreement"));return}if(!d.is_rules){v.error(a("Please agree to the rules"));return}const r=t.id!==null,n=d.thumbnail instanceof File,o=g instanceof File,b=d.ebook_file&&typeof d.ebook_file=="string";if(r){if(!n&&!t.thumbnail){v.error(a("Thumbnail is required."));return}if(!y&&!o&&!b){v.error(a("Ebook file is required for local upload."));return}if(y&&!b&&!o){v.error(a("Please select an ebook file from FTP."));return}}else{if(!n){v.error(a("Thumbnail is required."));return}if(!y&&!o){v.error(a("Ebook file is required for local upload."));return}if(y&&!b){v.error(a("Please select an ebook file from FTP."));return}}x(!0),o&&!y?Ce():(t.id===null?H():Y(),x(!1))};return console.log(d,"data"),i(Fe,{children:[e(De,{title:a("Upload ebook")}),i("div",{className:"lg:flex lg:space-x-10",children:[e(Ae,{active:"upload-ebook"}),i("div",{className:"p-4 sm:p-8 bg-white w-full dark:bg-zinc-900 shadow sm:rounded-lg",children:[i("header",{className:"mb-5",children:[i("h2",{className:"text-lg inline-flex items-center md:text-xl font-medium text-gray-600 dark:text-gray-100",children:[e(je,{className:"mr-2"}),t.id===null?a("Upload ebook"):a("Edit ebook")]}),e("p",{className:"mt-1 mb-2 text-sm text-gray-600 dark:text-gray-400",children:a("Upload a new ebook")}),e(Ee,{className:"bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700",href:route("ebook.list"),children:a("<< Back to ebook")})]}),e("hr",{className:"my-5"}),i("form",{onSubmit:ke,encType:"multipart/form-data",children:[i("div",{className:"mb-5",children:[e(c,{for:"title_en",value:a("Title")}),e(f,{name:"title_en",value:d.title_en,handleChange:s=>h("title_en",s.target.value),required:!0,className:"mt-1 block w-full md:w-1/2"}),e(p,{message:m.title_en,className:"mt-2"})]}),i("div",{className:"mb-5",children:[e(c,{htmlFor:"title_lang",value:a("Select Title Language")}),i("select",{name:"title_lang",value:d.title_lang,onChange:Ne,className:"mt-1 block w-full md:w-1/2 border-zinc-300 dark:border-zinc-700 dark:bg-zinc-800 dark:text-gray-300 rounded-md shadow-sm",children:[e("option",{value:"",children:a("--Select--")}),w&&w.map(s=>e("option",{value:s.lang_value,children:s.lang_name},`title-locale-${s.lang_value}`))]})]}),i("div",{className:"mb-5",children:[e(c,{htmlFor:"title_lang_val",value:`${((ie=w.find(s=>s.lang_value===d.title_lang))==null?void 0:ie.lang_name)||"Translated"} Title`}),e(f,{name:"title_lang_val",value:d.title_lang_val,handleChange:_,className:"mt-1 block w-full md:w-1/2"}),e(p,{message:m.title_lang_val,className:"mt-2"})]}),i("div",{className:"mb-5",children:[e(c,{for:"category",value:a("Category")}),e(S,{mode:"multiple",allowClear:!0,showSearch:!0,style:{width:"50%"},placeholder:a("Please select"),value:F,onChange:be,options:ce,filterOption:(s,r)=>{var n;return((n=r==null?void 0:r.label)!=null?n:"").toLowerCase().includes(s.toLowerCase())}}),e(p,{message:m.category_id,className:"mt-2"})]}),i("div",{className:"mb-5",children:[e(c,{for:"model",value:a("Model")}),e(S,{mode:"multiple",allowClear:!0,showSearch:!0,style:{width:"50%"},placeholder:a("Please select"),value:P,onChange:ye,options:oe,filterOption:(s,r)=>{var n;return((n=r==null?void 0:r.label)!=null?n:"").toLowerCase().includes(s.toLowerCase())}}),e(p,{message:m.model_id,className:"mt-2"})]}),i("div",{className:"mb-5",children:[e(c,{for:"tag",value:a("Tags")}),e(S,{mode:"multiple",allowClear:!0,showSearch:!0,style:{width:"50%"},placeholder:a("Please select"),value:A,onChange:ve,options:me,filterOption:(s,r)=>{var n;return((n=r==null?void 0:r.label)!=null?n:"").toLowerCase().includes(s.toLowerCase())}}),e(p,{message:m.tag,className:"mt-2"})]}),i("div",{className:"flex w-full md:w-1/2 flex-col md:flex-row md:items-center md:space-x-10 md:justify-between",children:[i("div",{className:"mb-5",children:[e(c,{for:"price",value:a("Price")}),i("div",{className:"flex items-center",children:[e(f,{type:"number",name:"price",value:d.price,handleChange:_,required:!0,className:"mt-1 w-32"}),e("div",{className:"ml-1 dark:text-white text-gray-700",children:a("tokens")})]}),e(p,{message:m.price,className:"mt-2"})]}),i("div",{className:"mb-5",children:[e(c,{for:"free_for_subs",value:a("Free for subscribers?")}),i("select",{name:"free_for_subs",value:d.free_for_subs,onChange:_,required:!0,className:"mt-1 block w-32 border-zinc-300 dark:border-zinc-700 dark:bg-zinc-800 dark:text-gray-300 focus:border-indigo-500 dark:focus:border-indigo-600 focus:ring-indigo-500 dark:focus:ring-indigo-600 rounded-md shadow-sm",children:[e("option",{value:"yes",children:a("Yes")}),e("option",{value:"no",children:a("No")})]}),e(p,{message:m.free_for_subs,className:"mt-2"})]})]}),i("div",{className:"mb-5",children:[e(c,{for:"thumbnail",value:a("Thumbnail")}),e(f,{className:"p-1 block w-full md:w-1/2 text-gray-900 border border-gray-300 rounded-lg cursor-pointer bg-gray-50 dark:text-gray-300 focus:outline-none dark:bg-zinc-800 dark:border-gray-600 dark:placeholder-zinc-900",type:"file",name:"thumbnail",handleChange:fe,required:t.id===null}),e(p,{message:m.thumbnail,className:"mt-2"}),R&&e("img",{src:R,alt:"Thumbnail Preview",className:"mt-2 w-32 h-32 object-cover rounded-lg"})]}),e("div",{className:"mb-5",children:i("label",{className:"flex items-center space-x-2",children:[e(ze,{onChange:ue,checked:y}),e("span",{children:"Select ebook from FTP?"})]})}),!y&&i("div",{className:"mb-5",children:[e(c,{for:"ebook_file_input",value:a("Ebook File")}),e(f,{className:"p-1 block w-full md:w-1/2 text-gray-900 border border-gray-300 rounded-lg cursor-pointer bg-gray-50 dark:text-gray-300 focus:outline-none dark:bg-zinc-800 dark:border-gray-600 dark:placeholder-zinc-900",type:"file",name:"ebook_file_input",accept:".pdf",handleChange:pe,required:t.id===null}),e(p,{message:m.ebook_file_input,className:"mt-2"}),g&&g.name&&e("p",{className:"text-sm text-gray-500 mt-1",children:g.name}),t.ebook_file&&typeof t.ebook_file=="string"&&!g&&i("p",{className:"text-sm text-gray-500 mt-1",children:["Current file: ",t.ebook_file.split("/").pop()]})]}),y&&i("div",{className:"mt-2",children:[e(S,{style:{width:"50%"},placeholder:a("Please select"),value:d.ebook_file,onChange:ge,options:_e,required:t.id===null}),e(p,{message:m.ebook_file,className:"mt-2"})]}),i("div",{className:"mb-5",children:[e(c,{for:"description_en",value:a("Description (English)")}),e(de,{name:"description_en",value:d.description_en||"",handleChange:s=>h("description_en",s.target.value),required:!0,className:"mt-1 block w-full md:w-1/2"}),e(p,{message:m.description_en,className:"mt-2"})]}),i("div",{className:"mb-5",children:[e(c,{htmlFor:"description_lang",value:a("Select Description Language")}),i("select",{name:"description_lang",value:d.description_lang,onChange:we,className:"mt-1 block w-full md:w-1/2",children:[e("option",{value:"",children:a("--Select--")}),w.map(s=>e("option",{value:s.lang_value,children:s.lang_name},s.lang_value))]})]}),i("div",{className:"mb-5",children:[e(c,{htmlFor:"description_lang_val",value:`${((ne=w.find(s=>s.lang_value===d.description_lang))==null?void 0:ne.lang_name)||"Translated"} Description`}),e(de,{name:"description_lang_val",value:d.description_lang_val,handleChange:_,className:"mt-1 block w-full md:w-1/2"})]}),e("hr",{className:"mt-3"}),e("label",{children:"SEO"}),i("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i("div",{children:[e(c,{for:"seo_h2",value:"H2"}),e(f,{name:"seo.h2",value:d.seo.h2,handleChange:_,className:"mt-1 block w-full"})]}),i("div",{children:[e(c,{for:"seo_keyword",value:"Keyword"}),e(f,{name:"seo.keyword",value:d.seo.keyword,handleChange:_,className:"mt-1 block w-full"})]}),i("div",{children:[e(c,{for:"seo_meta_keyword",value:"Meta Keyword"}),e(f,{name:"seo.meta_keyword",value:d.seo.meta_keyword,handleChange:_,className:"mt-1 block w-full"})]}),i("div",{children:[e(c,{for:"seo_desc",value:"Meta Description"}),e(f,{name:"seo.desc",value:d.seo.desc,handleChange:_,className:"mt-1 block w-full"})]}),i("div",{children:[e(c,{for:"seo_og_title",value:"OG Title"}),e(f,{name:"seo.og_title",value:d.seo.og_title,handleChange:_,className:"mt-1 block w-full"})]}),i("div",{children:[e(c,{for:"seo_og_desc",value:"OG Description"}),e(f,{name:"seo.og_desc",value:d.seo.og_desc,handleChange:_,className:"mt-1 block w-full"})]}),i("div",{children:[e(c,{for:"seo_meta_robot",value:"Meta Robot"}),e(f,{name:"seo.meta_robot",value:d.seo.meta_robot,handleChange:_,className:"mt-1 block w-full"})]}),i("div",{children:[e(c,{for:"seo_cust_url",value:"Custom URL"}),e(f,{name:"seo.cust_url",value:d.seo.cust_url,handleChange:_,className:"mt-1 block w-full"})]}),i("div",{children:[e(c,{for:"seo_og_image_url",value:"OG Image URL"}),e(f,{name:"seo.og_image_url",value:d.seo.og_image_url,handleChange:_,className:"mt-1 block w-full"})]}),i("div",{children:[e(c,{for:"seo_json_id",value:"JSON ID"}),e(f,{name:"seo.json_id",value:d.seo.json_id,handleChange:_,className:"mt-1 block w-full"})]})]}),i("div",{className:"mt-4",children:[e(j,{name:"is_terms",checked:d.is_terms,handleChange:_}),i("span",{className:"mx-2",children:[a(" Agree to "),e("a",{href:"policy/Terms.pdf",className:"underline",target:"_blank",children:a("Terms and Conditions")})]}),e(p,{message:m.is_terms,className:"mt-2"})]}),i("div",{className:"mt-4",children:[e(j,{name:"is_agreement",checked:d.is_agreement,handleChange:_}),i("span",{className:"mx-2",children:[a(" Agree to "),e("a",{href:"policy/Streamer-Agreement.pdf",className:"underline",target:"_blank",children:a("Agreement")})]}),e(p,{message:m.is_agreement,className:"mt-2"})]}),i("div",{className:"mt-4",children:[e(j,{name:"is_rules",checked:d.is_rules,handleChange:_}),i("span",{className:"mx-2",children:[a(" Agree to "),e("a",{href:"policy/Content-Rules.pdf",className:"underline",target:"_blank",children:a("Rules")})]}),e(p,{message:m.is_rules,className:"mt-2"})]}),e("div",{className:"mt-5",children:e(Pe,{type:"submit",processing:U,disabled:U,children:t.id===null?a("Upload"):a("Save Changes")})})]})]})]})]})}export{nt as default};
