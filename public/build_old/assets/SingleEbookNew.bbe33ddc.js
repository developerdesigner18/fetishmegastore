import{j as r,a as e,H as A,r as i,d as y,F as p,L as S,h as j,i as H}from"./app.19cefab4.js";import{A as V}from"./AuthenticatedLayout.8df4bd0c.js";import $ from"./EbookLoop.81eb4278.js";import{_ as a}from"./Translate.dc83ae5b.js";import{a as G,b as O,c as Q,d as Y,g as D,e as J}from"./index.44fa3034.js";import{d as K}from"./index.b807ca24.js";import{F as W,a as X}from"./index.98f96573.js";import{S as B}from"./Spinner.35c7a0bf.js";import{P as b}from"./PrimaryButton.13d0606e.js";import{Q as I}from"./react-toastify.esm.594ac60b.js";import{M as L,h as Z,c as ee}from"./index.6ccb561e.js";import{j as te}from"./index.e40f57f7.js";import{S as M}from"./SecondaryButton.6b452f2f.js";import{M as re}from"./Modal.a58146e0.js";import se from"./ShareLink.6d28dcb1.js";import{I as ae}from"./InputLabel.dc3a6c34.js";import ie from"./SubscribePopup.47d3bbf9.js";import{I as ne}from"./InputError.6c9d0edc.js";import{T as le}from"./Textarea.5f22d4b5.js";/* empty css             */import{M as ce}from"./index.esm.a625d265.js";import"./Front.ff2cd402.js";import"./iconBase.c21c0bbc.js";import"./index.7638ddab.js";import"./react-cookie-consent.esm.6827f7e8.js";import"./transition.96a9edea.js";import"./TextInput.578de99c.js";import"./index.e7e076b2.js";import"./index.esm.3513504a.js";import"./react-tooltip.min.6093dea3.js";/* empty css                          */import"./SingleAudio.56035c2b.js";import"./Loader.76160d32.js";import"./index.923adbc5.js";const oe=({ebook:t,relatedebook:x,url:o,inModal:n,authUser:u})=>{var _,C;console.log("ebook:",t),i.exports.useState();const[c,h]=i.exports.useState(!1),[f,g]=i.exports.useState(!1);i.exports.useState(!1);const[d,N]=i.exports.useState(t.isUserFavorite),[l,m]=i.exports.useState(null),[k,E]=i.exports.useState(!1),[xe,U]=i.exports.useState(!1),[w,ue]=i.exports.useState(""),P=(s,v)=>{s.preventDefault(),h(v),g(!0)},T=()=>{N(!0),y.post(route("ebook.addToFavorite",{id:t.id}))},R=()=>{N(!1),y.post(route("ebook.removeFromFavorite",{id:t.id}))};i.exports.useEffect(()=>{(t==null?void 0:t.id)&&!n&&z()},[t.id,n]);const z=()=>{y.post(route("ebook.increaseEbookViews",{ebook:t.id})).then(()=>{U(!0)}).catch(s=>{console.error("Error increasing views:",s)})},F=async()=>{E(!0),m(null);try{window.location.href=route("ebook.download",{ebook:t.id})}catch(s){console.error("Download error:",s),m(a("An error occurred while initiating download."))}finally{E(!1)}},q=()=>{window.open(route("ebook.stream",{ebook:t.id}),"_blank")};return r(p,{children:[e(re,{show:f,onClose:s=>g(!1),children:c&&e(se,{link:c,inModal:!0})}),r("div",{className:`justify-center w-full ${n?"p-3":"p-0"}`,children:[r("div",{className:"flex items-start",children:[e("div",{className:"mr-5 flex flex-col items-center flex-shrink-0",children:e(S,{href:route("channel",{user:t.streamer.username}),children:e("img",{src:t.streamer.profile_picture,className:"w-14 h-14 rounded-full"})})}),r("div",{children:[e("h3",{className:"text-lg md:text-2xl font-light dark:text-indigo-100 hover:text-indigo-800 text-indigo-600 dark:hover:text-indigo-400",children:t.title}),r("div",{className:"flex items-center flex-wrap md:space-x-2 mt-1",children:[r(S,{href:route("channel",{user:t.streamer.username}),className:"text-sm text-gray-600 mr-2  dark:text-white",children:["@",t.streamer.username]}),(_=t.selectedCategory)==null?void 0:_.map((s,v)=>r(S,{href:route("ebook.browse",{videocategory:s.value,slug:`-${s.label}`}),className:"text-gray-600 mr-2  inline-flex items-center space-x-1 dark:text-zinc-100 text-sm",children:[e(G,{className:"w-3"}),e("span",{children:s.label})]})),e(O,{className:"w-3"}),e("span",{children:(C=t==null?void 0:t.tags)==null?void 0:C.map((s,v)=>r(S,{href:route("tag",{id:s.id}),className:"text-gray-600 mr-2  inline-flex items-center space-x-1 dark:text-zinc-100 text-sm",children:[" ",r("span",{children:[s.name," ",v!==t.tags.length-1&&", "]})]}))}),t.free_for_subs==="yes"&&t.price!==0&&r("div",{className:"mt-1 md:mt-0 inline-flex items-center text-sm bg-gray-100 rounded px-2 py-1 text-gray-500 dark:text-gray-600",children:[e(te,{className:"w-4 h-4 mr-1"}),a("Free For Subscribers")]}),t.canDownload&&e("div",{className:"mt-1 md:mt-0 inline-flex items-center text-sm bg-gray-100 rounded px-2 py-1 text-gray-500 dark:text-gray-600",children:e("button",{onClick:F,className:"relative flex items-center justify-center",disabled:k,children:k?e("span",{className:"loader"}):a("Download")})}),w&&e("p",{className:"text-gray-600 mt-2 text-sm",children:w}),l&&e("p",{className:"text-red-500",children:l}),e("div",{className:"mt-1 md:mt-0 inline-flex items-center text-sm bg-gray-100 rounded px-2 py-1 text-gray-500 dark:text-gray-600",children:r("span",{children:[" ",a("Duration ")," : ",t.duration.minute]})}),e("div",{className:"mt-1 md:mt-0 inline-flex items-center text-sm bg-gray-100 rounded px-2 py-1 text-gray-500 dark:text-gray-600",children:r("span",{children:[" ",a("Resolution ")," : ",t.duration.resolution]})}),r("div",{className:"mt-1 md:mt-0 inline-flex items-center text-sm bg-gray-100 rounded px-2 py-1 text-gray-500 dark:text-gray-600 cursor-pointer",onClick:s=>P(s,document.URL),children:[e(Q,{className:"w-4 h-4 mr-1"}),a("Share ")]}),e("div",{className:"mt-1 md:mt-0 inline-flex items-center text-sm bg-gray-100 rounded px-2 py-1 text-gray-500 dark:text-gray-600",children:e(ie,{user:t.streamer,userIsSubscribed:t.isCurrentSubscriber})}),d?r(p,{children:[e("div",{className:"mt-1 md:mt-0 inline-flex items-center text-sm rounded px-2 py-1 cursor-pointer",onClick:s=>R(),children:e(Y,{style:{color:"red"},className:"w-4 h-4 mr-1"})}),r("div",{className:"mt-1 md:mt-0 inline-flex items-center text-sm rounded px-2 py-1 cursor-pointer",children:[e(D,{style:{color:"red"},className:"w-4 h-4 mr-1"}),e("span",{children:t==null?void 0:t.views})]})]}):r(p,{children:[e("div",{className:"mt-1 md:mt-0 inline-flex items-center text-sm rounded px-2 py-1 cursor-pointer",onClick:s=>T(),children:e(J,{style:{color:"red"},className:"w-4 h-4 mr-1"})}),r("div",{className:"mt-1 md:mt-0 inline-flex items-center text-sm rounded px-2 py-1 cursor-pointer",children:[e(D,{style:{color:"red"},className:"w-4 h-4 mr-1"}),e("span",{children:t==null?void 0:t.views})]})]}),t.ebook_file&&t.ebook&&e(p,{children:!t.canBePlayed&&r("div",{className:"mt-1 md:mt-0 inline-flex items-center text-sm bg-yellow-300 rounded px-2 py-1 text-gray-500 dark:text-gray-600 cursor-pointer",onClick:s=>j.Inertia.visit(route("ebook.unlock",{ebook:t.id})),children:[e(L,{className:"w-4 h-4 mr-1"}),a("Unlock with :tokens tokens",{tokens:t.price})]})})]})]})]}),e("div",{className:"mt-5 text-center",children:!t.ebook_file&&!t.ebook?e("div",{className:"flex flex-col items-center justify-center py-10",children:e("p",{className:"text-red-500 text-lg font-semibold",children:"Something is wrong, Ebook was not found."})}):e(p,{children:t.canBePlayed?e("div",{className:"max-w-xl mx-auto",children:r("div",{className:"relative rounded-lg overflow-hidden border border-gray-200 dark:border-zinc-700 shadow-md",children:[t.thumbnail?e("img",{src:`/${t.thumbnail}`,alt:t.title_en,className:"w-full h-auto object-cover"}):e(ce,{className:"text-gray-400 text-9xl mx-auto my-10"}),r("div",{className:"absolute inset-0 bg-black bg-opacity-40 flex flex-col items-center justify-center text-white p-4",children:[r("div",{className:"flex space-x-3",children:[r(b,{onClick:q,className:"inline-flex items-center",children:[e(K,{className:"w-5 h-5 mr-2"}),a("View Ebook")]}),r(M,{onClick:F,className:"inline-flex items-center",children:[e(Z,{className:"w-5 h-5 mr-2"}),a("Download Ebook")]})]}),w&&e("p",{className:"text-green-300 mt-2 text-sm",children:w}),l&&e("p",{className:"text-red-300 mt-2 text-sm",children:l})]})]})}):r("div",{className:"flex flex-col items-center justify-center max-w-lg mx-auto",children:[e("img",{src:t.thumbnail||"/default-thumbnail.jpg",alt:"Ebook Preview",className:"rounded-lg w-full h-auto object-cover"}),r("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-black bg-opacity-60 text-white p-4 text-center rounded-lg",children:[e("div",{className:"bg-white inline-flex bg-opacity-25 rounded-full p-2",children:e(W,{className:"w-12 h-12"})}),t.price>0&&r(b,{className:"h-12 mt-5 inline-flex",onClick:()=>j.Inertia.visit(route("ebook.unlock",{ebook:t.id})),children:[e(L,{className:"mr-2 w-6 h-6 md:w-8 md:h-8"}),a("Unlock with :tokens tokens",{tokens:t.price})]}),t.price<=0&&e("p",{className:"text-lg font-semibold mt-3",children:a("You need to unlock to read this ebook.")})]})]})})}),e("div",{className:"mt-5 dark:text-indigo-100 hover:text-indigo-800 text-indigo-600 dark:hover:text-indigo-400",children:t.description?t.description:""})]})]})},de=({relatedebook:t})=>{const[x,o]=i.exports.useState(""),[n,u]=i.exports.useState(!1),[c,h]=i.exports.useState("");i.exports.useEffect(()=>{h(t.data),o(t.next_page_url)},[]);const f=async g=>{u(!0);try{const d=await y.get(g);h([...c,...d.data.data]),o(d.data.next_page_url),u(!1)}catch(d){console.log(d)}};return r("div",{children:[r("div",{className:"flex justify-start items-center mt-20 mb-8",children:[e(ee,{className:"text-pink-600 text-4xl mr-1"}),e("h2",{className:"text-indigo-900 text-center dark:text-zinc-200 text-4xl font-semibold",children:a("Related ebook")})]}),r("div",{className:"mt-5 mb-5",children:[t.total===0&&r("div",{className:"text-xl bg-white rounded-lg shadow text-gray-600 dark:bg-zinc-900 dark:text-white font-light p-3 flex items-center",children:[e(X,{className:"w-12 h-12 mr-2"}),a("No ebook to show")]}),c.length>0&&e($,{ebook:c}),t.last_page>1&&e(p,{children:n?e("div",{className:"my-3",children:e(B,{})}):e(M,{className:"mt-2",processing:!t.next_page_url,onClick:()=>f(x),children:a("Load More")})})]})]})},me=({ebook:t})=>{const[x,o]=i.exports.useState(!1),{data:n,setData:u,post:c,processing:h,errors:f,reset:g}=H({description:"",ebook_id:t.id}),d=l=>{u(l.target.name,l.target.type==="checkbox"?l.target.checked:l.target.value)},N=async l=>{l.preventDefault(),o(!0);try{await y({method:"post",url:route("request.ebook"),data:n,headers:{"Content-Type":"multipart/form-data"}}).then(function(m){I.success(m.data.message)}).catch(function(m){I.error(m)}),o(!1)}catch(m){console.log(m)}};return e(p,{children:r("div",{className:"mt-5 mb5",children:[e("h3",{className:"text-indigo-900 text-center dark:text-zinc-200 text-4xl font-semibold",children:a("Request ebook")}),r("form",{onSubmit:N,children:[r("div",{className:"mb-5",children:[e(ae,{for:"description",value:a("Description")}),e(le,{name:"description",value:n.description,handleChange:d,required:!0,className:"mt-1 block w-full"}),e(ne,{message:f.title,className:"mt-2"})]}),e("div",{className:"flex items-center justify-end mt-4",children:x?e("div",{className:"my-3",children:e(B,{})}):e(b,{className:"ml-4",processing:h,children:a("Request ebook")})})]})]})})};function Ye({ebook:t,relatedebook:x,url:o,inModal:n=!1,authUser:u}){const c=u;return r(V,{children:[e(A,{title:(t==null?void 0:t.title_en)||"Ebook Details"}),e(oe,{ebook:t,relatedebook:x,url:o,inModal:n,authUser:c}),!n&&e(de,{relatedebook:x}),!n&&e(me,{ebook:t})]})}export{Ye as default};
