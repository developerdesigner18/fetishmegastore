import{I as d}from"./InputLabel.6cbec6be.js";import{I as p}from"./InputError.f2e3760f.js";import{T as f}from"./TextInput.0e1ed875.js";import{T as W}from"./Textarea.31a73792.js";import{P as G}from"./PrimaryButton.0269d743.js";import{_ as s}from"./Translate.dc83ae5b.js";import{Q as C}from"./react-toastify.esm.ce806bab.js";import{A as fe}from"./AuthenticatedLayout.6c76f410.js";import{i as _e,r as u,d as ve,j as l,a as e,H as we,h as ye,F as J}from"./app.ce2bc0e2.js";import{S as be}from"./Spinner.85b600cb.js";import{c as ke}from"./index.58d9d0d7.js";import Ne from"./AccountNavi.e29596be.js";import{S as v}from"./sweetalert2.esm.all.08ba7c87.js";import{C as F}from"./Checkbox.c4c0f7bc.js";import{S as x}from"./Front.91155685.js";import"./index.b7ddb5c7.js";import"./iconBase.7698d573.js";import"./index.f3d7e524.js";import"./react-cookie-consent.esm.d4545ed5.js";import"./transition.0f9bd53b.js";import"./Modal.1099fe94.js";import"./index.e7e076b2.js";import"./index.esm.bb993f23.js";function Je({video:t,ogValue:r,categories:X,fileNames:Z,tags:L,models:V,systemVideo:ee,isEdit:A,supportedLocales:g}){var I,M,q,j,Y,E,H,O,R,K;console.log("preview deatils",t);const{data:n,setData:y,post:b,processing:ae,errors:m,progress:P}=_e({title_en_val:((I=r==null?void 0:r.title)==null?void 0:I.en)||"",title_lang:(r==null?void 0:r.title_lang)||"",title_de:((M=r==null?void 0:r.title)==null?void 0:M[r==null?void 0:r.title_lang])||"",description_en_val:((q=r==null?void 0:r.description)==null?void 0:q.en)||"",description_lang:(r==null?void 0:r.description_lang)||"",description_de:((j=r==null?void 0:r.description)==null?void 0:j[r==null?void 0:r.description_lang])||"",tag:t.tag,category_id:t.category_id,model_id:t.model_id,video_id:t.video_id,price:t.price,is_from_ftp:!1,thumbnail:"",video_file:"",is_terms:"",is_agreement:"",is_rules:"",seo:{h2:(Y=t.seoDeatils)==null?void 0:Y.h2,keyword:(E=t.seoDeatils)==null?void 0:E.keyword,meta_keyword:(H=t.seoDeatils)==null?void 0:H.meta_keyword,desc:(O=t.seoDeatils)==null?void 0:O.desc}}),[_,$]=u.exports.useState(""),[w,S]=u.exports.useState([]),[U,T]=u.exports.useState(!1),[te,Ce]=u.exports.useState(2),[le,D]=u.exports.useState(0),[k,z]=u.exports.useState(!1),[xe,se]=u.exports.useState([]);u.exports.useEffect(()=>{t&&((t==null?void 0:t.is_from_ftp)==1?(z(!0),n.is_from_ftp=!0):(t==null?void 0:t.is_from_ftp)==0&&(z(!1),n.is_from_ftp=!1)),se(t.category_id)},[]);const ne=a=>{const i=a.target.value,o=t.title||{};y(c=>({...c,title_lang:i,title_de:o[i]||""}))},re=a=>{const i=a.target.value,o=t.description||{};y(c=>({...c,description_lang:i,description_de:o[i]||""}))},ie=a=>{console.log(`selected ${a}`),$(a),n.video_file="short-videos/"+a,n.is_from_ftp=k},oe=a=>{console.log(`selected tag ${a}`),n.tag=a},ce=a=>{console.log(`selected category ${a}`),n.category_id=a},de=a=>{console.log(`selected model ${a}`),n.model_id=a},me=a=>{console.log(`selected video ${a}`),n.video_id=a};u.exports.useEffect(()=>{Object.keys(m).length&&Object.keys(m).map(a=>{C.error(m.key)})},[m]),u.exports.useEffect(()=>{w.length>0&&pe()},[w]);const h=a=>{const{name:i,type:o,checked:c,value:N}=a.target;i.startsWith("seo.")?y("seo",{...n.seo,[i.split(".")[1]]:o==="checkbox"?c:N}):y(i,o==="checkbox"?c:N)},he=()=>{S([]);let a=1024*1024*8,i=Math.ceil(_.size/a);for(let o=0;o<i;o++)S(c=>[...c,_.slice(o*a,Math.min(o*a+a,_.size),_.type)])},pe=()=>{T(!0);const a=new FormData;a.append("media_type","video"),a.append("from","short-videos"),a.append("is_last",w.length===1),a.append("video",te),a.set("file",w[0],`${_.name}.part`),ve.post(route("video.uploadChunks"),a,{onUploadProgress:i=>{D(le+i.loaded)}}).then(function(i){w.length<=1&&(S([]),D(0),n.video_file=i.data.result,console.log(i.data.result),console.log("Chunks.length <= 1, posting data"),console.log(n),t.id===null?v.fire({title:"Are you sure?",text:"Do you want to save this preview?",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, save it!",cancelButtonText:"No, cancel"}).then(c=>{c.isConfirmed?(b(route("preview.save")),v.fire("Saved!","Your preview has been saved.","success")):c.dismiss===v.DismissReason.cancel&&v.fire("Cancelled","Your preview has not been saved","error")}):B());let o=[...w];o.splice(0,1),S(o)}).catch(function(i){var o,c;D(0),C.error((c=(o=i.response)==null?void 0:o.data)==null?void 0:c.message)}).then(function(){T(!1)})},ge=a=>{if(a.preventDefault(),!n.is_terms){C.error(s("Please agree to terms and conditions"));return}if(!n.is_agreement){C.error(s("Please agree to the agreement"));return}if(!n.is_rules){C.error(s("Please agree to the rules"));return}console.log(_,"videoFile"),_?k?(T(!0),t.id===null?v.fire({title:"Are you sure?",text:"Do you want to save this preview?",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, save it!",cancelButtonText:"No, cancel"}).then(i=>{i.isConfirmed?(b(route("preview.save")),v.fire("Saved!","Your preview has been saved.","success")):i.dismiss===v.DismissReason.cancel&&v.fire("Cancelled","Your preview has not been saved","error")}):(console.log("ggwp"),b(route("preview.update",{video:t.id}))),T(!1)):he():_===""&&t.id!==null&&(k?(console.log("gg"),b(route("preview.update",{video:t.id}))):B())},B=()=>{b(route("preview.update",{video:t.id}))};console.log(n,"data"),console.log(t,"video");const ue=ee.map(a=>{var c,N,Q;const i=(c=a==null?void 0:a.label)==null?void 0:c.en,o=(Q=(N=a==null?void 0:a.label)==null?void 0:N.ogValue)==null?void 0:Q.title_lang;return{value:a==null?void 0:a.value,label:i||o||"Untitled Video"}});return l(fe,{children:[e(we,{title:s("Upload Video")}),l("div",{className:"lg:flex lg:space-x-10",children:[e(Ne,{active:"upload-videos"}),l("div",{className:"p-4 sm:p-8 bg-white w-full dark:bg-zinc-900 shadow sm:rounded-lg",children:[l("header",{className:"mb-5",children:[l("h2",{className:"text-lg inline-flex items-center md:text-xl font-medium text-gray-600 dark:text-gray-100",children:[e(ke,{className:"mr-2"}),t.id===null?s("Upload Preview"):s("Edit Preview")]}),e("p",{className:"mt-1 mb-2 text-sm text-gray-600 dark:text-gray-400",children:s("Upload a new Preview")}),e(G,{onClick:a=>ye.Inertia.visit(route("preview.list")),children:s("<< Back to Previews")})]}),e("hr",{className:"my-5"}),l("form",{onSubmit:ge,encType:"multipart/form-data",children:[l("div",{className:"mb-5",children:[e(d,{for:"title",value:s("Title")}),e(f,{name:"title_en_val",value:n.title_en_val,handleChange:h,required:!0,className:"mt-1 block w-full md:w-1/2"}),e(p,{message:m.title_en_val,className:"mt-2"})]}),l("div",{className:"mb-5",children:[e(d,{htmlFor:"title_lang",value:s("Select Title Language")}),l("select",{name:"title_lang",value:n.title_lang,onChange:ne,className:"mt-1 block w-full md:w-1/2 ...",children:[e("option",{value:"",children:s("--Select--")}),g&&g.map(a=>e("option",{value:a.lang_value,children:a.lang_name},`title-locale-${a.lang_value}`))]})]}),n.title_lang&&l("div",{className:"mb-5",children:[e(d,{htmlFor:"title_de",value:`${((R=g==null?void 0:g.find(a=>a.lang_value===n.title_lang))==null?void 0:R.lang_name)||"Translated"} Title`}),e(f,{name:"title_de",value:n.title_de,handleChange:h,className:"mt-1 block w-full md:w-1/2"})]}),l("div",{className:"mb-5",children:[e(d,{for:"category",value:s("Category")}),e(x,{mode:"multiple",allowClear:!0,showSearch:!0,style:{width:"50%"},placeholder:"Please select",defaultValue:t.selectedCategory,onChange:ce,options:X}),e(p,{message:m.category_id,className:"mt-2"})]}),l("div",{className:"mb-5",children:[e(d,{for:"model",value:s("Model")}),e(x,{mode:"multiple",allowClear:!0,showSearch:!0,style:{width:"50%"},placeholder:"Please select",defaultValue:t.model_id===null?[]:t.selectedModel,onChange:de,options:V}),e(p,{message:m.model_id,className:"mt-2"})]}),l("div",{className:"mb-5",children:[e(d,{for:"tag",value:s("Tags")}),e(x,{mode:"multiple",allowClear:!0,showSearch:!0,style:{width:"50%"},placeholder:"Please select",defaultValue:t.tags===null?[]:t.selectedTags,onChange:oe,options:L}),e(p,{message:m.tag,className:"mt-2"})]}),l("div",{className:"mb-5",children:[e(d,{for:"model",value:s("Full Video Link")}),e(x,{allowClear:!0,showSearch:!0,style:{width:"50%"},placeholder:"Please select",defaultValue:t.video_id===null?[]:t.fullVideoLink,onChange:me,options:ue}),e(p,{message:m.video_id,className:"mt-2"})]}),l("div",{className:"mb-5",children:[e(d,{for:"price",value:s("Price")}),l("div",{className:"flex items-center",children:[e(f,{type:"number",name:"price",value:n.price,handleChange:h,required:!0,className:"mt-1  w-32"}),l("div",{className:"ml-1 dark:text-white text-gray-700",children:[s("tokens")," ",s("0 = Free")]})]}),e(p,{message:m.price,className:"mt-2"})]}),l("div",{className:"mb-5",children:[e(d,{for:"thumbnail",value:s("Thumbnail - helps to attract sales (will be resized to 640x320px)")}),A&&e(J,{children:l("span",{className:"text-red-900",children:[" ",s("Upload only if you want to make a change")]})}),e(f,{className:"p-1 block w-full md:w-1/2 text-gray-900 border border-gray-300 rounded-lg cursor-pointer bg-gray-50 dark:text-gray-300 focus:outline-none dark:bg-zinc-800 dark:border-gray-600 dark:placeholder-zinc-900",type:"file",name:"thumbnail",handleChange:a=>y("thumbnail",a.target.files[0]),required:t.id===null}),e(p,{message:m.thumbnail,className:"mt-2"})]}),!k&&l("div",{className:"mb-5",children:[e(d,{for:"video",value:s("Video")}),A&&e(J,{children:l("span",{className:"text-red-900",children:[" ",s("Upload only if you want to make a change")]})}),e(f,{className:"p-1 block w-full md:w-1/2 text-gray-900 border border-gray-300 rounded-lg cursor-pointer bg-gray-50 dark:text-gray-300 focus:outline-none dark:bg-zinc-800 dark:border-gray-600 dark:placeholder-zinc-900",type:"file",name:"video",accept:"video/mp4,video/webm,video/ogg,video/quicktime,video/qt,video/mov",handleChange:a=>$(a.target.files[0]),required:t.id===null}),e(p,{message:m.video_file,className:"mt-2"})]}),k&&e("div",{className:"mt-2",children:e(x,{mode:"single",allowClear:!0,showSearch:!0,style:{width:"50%"},placeholder:"Please select",defaultValue:t.video,onChange:ie,options:Z})}),l("div",{className:"mb-5",children:[e(d,{for:"description_en_val",value:s("Description")}),e(W,{name:"description_en_val",value:n.description_en_val,handleChange:h,required:!0,className:"mt-1 block w-full md:w-1/2"}),e(p,{message:m.description_en_val,className:"mt-2"})]}),l("div",{className:"mb-5",children:[e(d,{htmlFor:"description_lang",value:s("Select Description Language")}),l("select",{name:"description_lang",value:n.description_lang,onChange:re,className:"mt-1 block w-full md:w-1/2",children:[e("option",{value:"",children:s("--Select--")}),g&&g.map(a=>e("option",{value:a.lang_value,children:a.lang_name},`desc-locale-${a.lang_value}`))]})]}),n.description_lang&&l("div",{className:"mb-5",children:[e(d,{htmlFor:"description_de",value:`${(K=g==null?void 0:g.find(a=>a.lang_value===n.description_lang))==null?void 0:K.lang_name} ${s("Description")}`}),e(W,{name:"description_de",value:n.description_de,handleChange:h,className:"mt-1 block w-full md:w-1/2"})]}),e("hr",{className:"mt-3"}),e("label",{children:"SEO"}),l("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l("div",{children:[e(d,{for:"seo_h2",value:"H2"}),e(f,{name:"seo.h2",value:n.seo.h2,handleChange:h,className:"mt-1 block w-full"})]}),l("div",{children:[e(d,{for:"seo_keyword",value:"Keyword"}),e(f,{name:"seo.keyword",value:n.seo.keyword,handleChange:h,className:"mt-1 block w-full"})]}),l("div",{children:[e(d,{for:"seo_meta_keyword",value:"Meta Keyword"}),e(f,{name:"seo.meta_keyword",value:n.seo.meta_keyword,handleChange:h,className:"mt-1 block w-full"})]}),l("div",{children:[e(d,{for:"seo_desc",value:"Meta Description"}),e(f,{name:"seo.desc",value:n.seo.desc,handleChange:h,className:"mt-1 block w-full"})]})]}),l("div",{className:"mt-4",children:[e(F,{name:"is_terms",checked:n.is_terms,handleChange:h}),l("span",{className:"mx-2",children:[s(" Agree to "),e("a",{href:"policy/Terms.pdf",className:"underline",target:"_blank",children:s("Terms and Conditions")})]}),e(p,{message:m.is_terms,className:"mt-2"})]}),l("div",{className:"mt-4",children:[e(F,{name:"is_agreement",checked:n.is_agreement,handleChange:h}),l("span",{className:"mx-2",children:[s(" Agree to "),e("a",{href:"policy/Streamer-Agreement.pdf",className:"underline",target:"_blank",children:s("Agreement")})]}),e(p,{message:m.is_agreement,className:"mt-2"})]}),l("div",{className:"mt-4",children:[e(F,{name:"is_rules",checked:n.is_rules,handleChange:h}),l("span",{className:"mx-2",children:[s(" Agree to "),e("a",{href:"policy/Content-Rules.pdf",className:"underline",target:"_blank",children:s("Rules")})]}),e(p,{message:m.is_rules,className:"mt-2"})]}),e("div",{className:"flex justify-between items-center mt-2",children:e(G,{processing:ae||U,children:t.id===null?s("Save Preview"):s("Update Preview")})}),U&&e("div",{className:"my-3",children:e(be,{})}),P&&l("progress",{className:"mt-5",value:P.percentage,max:"100",children:[P.percentage,"%"]})]})]})]})]})}export{Je as default};
