import{I as c}from"./InputLabel.6cbec6be.js";import{I as p}from"./InputError.f2e3760f.js";import{T as h}from"./TextInput.0e1ed875.js";import{T as se}from"./Textarea.31a73792.js";import{P as te}from"./PrimaryButton.0269d743.js";import{_ as n}from"./Translate.dc83ae5b.js";import{Q as b}from"./react-toastify.esm.ce806bab.js";import{A as ye}from"./AuthenticatedLayout.6c76f410.js";import{i as Ce,r as u,d as xe,j as a,a as e,H as Se,h as Te}from"./app.ce2bc0e2.js";import{c as De}from"./index.58d9d0d7.js";import Ae from"./AccountNavi.e29596be.js";import{S as y}from"./sweetalert2.esm.all.08ba7c87.js";import{C as S}from"./Checkbox.c4c0f7bc.js";import{S as C}from"./Front.91155685.js";import{S as Fe}from"./index.cad9cf18.js";import"./index.b7ddb5c7.js";import"./iconBase.7698d573.js";import"./index.f3d7e524.js";import"./react-cookie-consent.esm.d4545ed5.js";import"./transition.0f9bd53b.js";import"./Modal.1099fe94.js";import"./index.e7e076b2.js";import"./index.esm.bb993f23.js";function ls({audio:s,ogValue:l,categories:le,models:ae,tags:T,fileNames:ie,supportedLocales:N,selectedCategoryIds:re,selectedModelIds:ne,selectedTagNames:oe}){var q,E,I,R,$,B,H,Y,G,K,J,Q,W,X,Z,V;const{data:i,setData:_,post:D,processing:A,errors:d,progress:je}=Ce({title_en:((q=l==null?void 0:l.title)==null?void 0:q.en)||"",title_lang:(l==null?void 0:l.title_lang)||"",title_lang_val:((E=l==null?void 0:l.title)==null?void 0:E[l==null?void 0:l.title_lang])||"",description_en:((I=l==null?void 0:l.description)==null?void 0:I.en)||"",description_lang:(l==null?void 0:l.description_lang)||"",description_lang_val:((R=l==null?void 0:l.description)==null?void 0:R[l==null?void 0:l.description_lang])||"",tag:T||[],category_id:s.category_id||[],model_id:s.model_id||[],price:s.price||"",free_for_subs:s.free_for_subs||!1,is_from_ftp:s.is_from_ftp||!1,audio_file_input:null,audio_file:(s==null?void 0:s.audio_file)||"",thumbnail:null,is_terms:typeof s.is_terms=="boolean"?s.is_terms:!1,is_agreement:typeof s.is_agreement=="boolean"?s.is_agreement:!1,is_rules:typeof s.is_rules=="boolean"?s.is_rules:!1,seo:{h2:(($=s.seoDeatils)==null?void 0:$.h2)||"",keyword:((B=s.seoDeatils)==null?void 0:B.keyword)||"",meta_keyword:((H=s.seoDeatils)==null?void 0:H.meta_keyword)||"",desc:((Y=s.seoDeatils)==null?void 0:Y.desc)||"",og_title:((G=s.seoDeatils)==null?void 0:G.og_title)||"",og_desc:((K=s.seoDeatils)==null?void 0:K.og_desc)||"",meta_robot:((J=s.seoDeatils)==null?void 0:J.meta_robot)||"",cust_url:((Q=s.seoDeatils)==null?void 0:Q.cust_url)||"",og_image_url:((W=s.seoDeatils)==null?void 0:W.og_image_url)||"",json_id:((X=s.seoDeatils)==null?void 0:X.json_id)||""}}),[g,F]=u.exports.useState(null);u.exports.useState(s.thumbnail?`/${s.thumbnail}`:null),u.exports.useState(null);const[v,w]=u.exports.useState([]),[Pe,k]=u.exports.useState(!1),[ze,x]=u.exports.useState(0),[j,P]=u.exports.useState(s.is_from_ftp===1),[ce,z]=u.exports.useState(re||[]),[de,O]=u.exports.useState(ne||[]),[me,L]=u.exports.useState(oe||[]),_e=()=>{P(!j),_("is_from_ftp",!j)};u.exports.useEffect(()=>{var t,r,o,f;s&&(_({title_en:((t=l==null?void 0:l.title)==null?void 0:t.en)||"",title_lang:(l==null?void 0:l.title_lang)||"",title_lang_val:((r=l==null?void 0:l.title)==null?void 0:r[l==null?void 0:l.title_lang])||"",description_en:((o=l==null?void 0:l.description)==null?void 0:o.en)||"",description_lang:(l==null?void 0:l.description_lang)||"",description_lang_val:((f=l==null?void 0:l.description)==null?void 0:f[l==null?void 0:l.description_lang])||"",tag:s.tags&&typeof s.tags=="string"?s.tags.split(","):[],category_id:s.category_id||[],model_id:s.model_id||[],price:s.price||"",free_for_subs:s.free_for_subs||!1,thumbnail:"",audio_file:s.audio_file||"",is_terms:typeof s.is_terms=="boolean"?s.is_terms:!1,is_agreement:typeof s.is_agreement=="boolean"?s.is_agreement:!1,is_rules:typeof s.is_rules=="boolean"?s.is_rules:!1,seo:s.seo||{}}),P(s.is_from_ftp===1),z(s.category_id||[]),O(s.model_id||[]),L(s.tags&&typeof s.tags=="string"?s.tags.split(","):[]))},[s]);const he=t=>{const r=t.target.files[0];F(r),_("audio_file_input",r)},fe=t=>{F(null),_("audio_file","audio/"+t)},pe=t=>{const r=t.target.value,o=s.title||{};_(f=>({...f,title_lang:r,title_lang_val:o[r]||""}))},ue=t=>{const r=t.target.value,o=s.description||{};_(f=>({...f,description_lang:r,description_lang_val:o[r]||""}))},ge=t=>{L(t),_("tag",t)},ve=t=>{z(t),_("category_id",t)},be=t=>{O(t),_("model_id",t)},m=t=>{const{name:r,type:o,checked:f,value:ee}=t.target;r.startsWith("seo.")?_("seo",{...i.seo,[r.split(".")[1]]:o==="checkbox"?f:ee}):_(r,o==="checkbox"?f:ee)};u.exports.useEffect(()=>{Object.keys(d).length&&Object.keys(d).forEach(t=>{b.error(d[t])})},[d]),u.exports.useEffect(()=>{v.length>0&&we()},[v]);const Ne=()=>{if(!g)return;w([]);let t=1024*1024*8,r=Math.ceil(g.size/t);for(let o=0;o<r;o++)w(f=>[...f,g.slice(o*t,Math.min(o*t+t,g.size))])},we=()=>{if(!g)return;k(!0);const t=new FormData;t.append("media_type","audio"),t.append("is_last",v.length===1),t.append("audio",s.id||0),t.set("file",v[0],`${g.name}.part`),xe.post(route("audio.uploadChunks"),t,{onUploadProgress:r=>x(o=>o+r.loaded)}).then(function(r){v.length<=1&&(w([]),x(0),_("audio_file",r.data.result),s.id?U():M()),w(o=>o.slice(1))}).catch(function(r){var o,f;x(0),b.error(((f=(o=r.response)==null?void 0:o.data)==null?void 0:f.message)||"Chunk upload failed.")}).finally(()=>{v.length===1&&k(!1)})},M=()=>{y.fire({title:"Are you sure?",text:"Do you want to save this audio?",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, save it!",cancelButtonText:"No, cancel"}).then(t=>{t.isConfirmed?(D(route("audio.saveAudio")),y.fire("Saved!","Your audio has been saved.","success")):t.dismiss===y.DismissReason.cancel&&y.fire("Cancelled","Your audio has not been saved","error")})},U=()=>{D(route("audio.update",{audio:s.id}))},ke=t=>{if(t.preventDefault(),!i.is_terms||!i.is_agreement||!i.is_rules){b.error(n("Please agree to all terms, agreements, and rules."));return}const r=!!s.id,o=g instanceof File;if(!r){if(!i.thumbnail){b.error(n("Thumbnail is required."));return}if(!i.is_from_ftp&&!o){b.error(n("Audio file is required for local upload."));return}if(i.is_from_ftp&&!i.audio_file){b.error(n("Please select an audio file from FTP."));return}}k(!0),o&&!i.is_from_ftp?Ne():(r?U():M(),k(!1))};return console.log(i,"data"),a(ye,{children:[e(Se,{title:n("Upload audio")}),a("div",{className:"lg:flex lg:space-x-10",children:[e(Ae,{active:"upload-audio"}),a("div",{className:"p-4 sm:p-8 bg-white w-full dark:bg-zinc-900 shadow sm:rounded-lg",children:[a("header",{className:"mb-5",children:[a("h2",{className:"text-lg inline-flex items-center md:text-xl font-medium text-gray-600 dark:text-gray-100",children:[e(De,{className:"mr-2"}),s.id===null?n("Upload audio"):n("Edit audio")]}),e("p",{className:"mt-1 mb-2 text-sm text-gray-600 dark:text-gray-400",children:n("Upload a new audio")}),e(te,{onClick:t=>Te.Inertia.visit(route("audio.list")),children:n("<< Back to audio")})]}),e("hr",{className:"my-5"}),a("form",{onSubmit:ke,encType:"multipart/form-data",children:[a("div",{className:"mb-5",children:[e(c,{for:"title_en",value:n("Title")}),e(h,{name:"title_en",value:i.title_en||s.title_en||s.title||"",handleChange:t=>_("title_en",t.target.value),required:!0,className:"mt-1 block w-full md:w-1/2"}),e(p,{message:d.title_en,className:"mt-2"})]}),a("div",{className:"mb-5",children:[e(c,{htmlFor:"title_lang",value:n("Select Title Language")}),a("select",{name:"title_lang",value:i.title_lang,onChange:pe,className:"mt-1 block w-full md:w-1/2 border-zinc-300 dark:border-zinc-700 dark:bg-zinc-800 dark:text-gray-300 rounded-md shadow-sm",children:[e("option",{value:"",children:n("--Select--")}),N&&N.map(t=>e("option",{value:t.lang_value,children:t.lang_name},`title-locale-${t.lang_value}`))]})]}),a("div",{className:"mb-5",children:[e(c,{htmlFor:"title_lang_val",value:`${((Z=N.find(t=>t.lang_value===i.title_lang))==null?void 0:Z.lang_name)||"Translated"} Title`}),e(h,{name:"title_lang_val",value:i.title_lang_val,handleChange:m,className:"mt-1 block w-full md:w-1/2"}),e(p,{message:d.title_lang_val,className:"mt-2"})]}),a("div",{className:"mb-5",children:[e(c,{for:"category",value:n("Category")}),e(C,{mode:"multiple",allowClear:!0,showSearch:!0,style:{width:"50%"},placeholder:"Please select",value:ce,onChange:ve,options:le,filterOption:(t,r)=>{var o;return((o=r==null?void 0:r.label)!=null?o:"").toLowerCase().includes(t.toLowerCase())}}),e(p,{message:d.category_id,className:"mt-2"})]}),a("div",{className:"mb-5",children:[e(c,{for:"model",value:n("Model")}),e(C,{mode:"multiple",allowClear:!0,showSearch:!0,style:{width:"50%"},placeholder:"Please select",value:de,onChange:be,options:ae,filterOption:(t,r)=>{var o;return((o=r==null?void 0:r.label)!=null?o:"").toLowerCase().includes(t.toLowerCase())}}),e(p,{message:d.model_id,className:"mt-2"})]}),a("div",{className:"mb-5",children:[e(c,{for:"tag",value:n("Tags")}),e(C,{mode:"multiple",allowClear:!0,showSearch:!0,style:{width:"50%"},placeholder:"Please select",value:me,onChange:ge,options:T,filterOption:(t,r)=>{var o;return((o=r==null?void 0:r.label)!=null?o:"").toLowerCase().includes(t.toLowerCase())}}),e(p,{message:d.tag,className:"mt-2"})]}),a("div",{className:"flex w-full md:w-1/2 flex-col md:flex-row md:items-center md:space-x-10 md:justify-between",children:[a("div",{className:"mb-5",children:[e(c,{for:"price",value:n("Price")}),a("div",{className:"flex items-center",children:[e(h,{type:"number",name:"price",value:i.price,handleChange:m,required:!0,className:"mt-1 w-32"}),e("div",{className:"ml-1 dark:text-white text-gray-700",children:n("tokens")})]}),e(p,{message:d.price,className:"mt-2"})]}),a("div",{className:"mb-5",children:[e(c,{for:"free_for_subs",value:n("Free for subscribers?")}),a("select",{name:"free_for_subs",value:i.free_for_subs,onChange:m,required:!0,className:"mt-1 block w-32 border-zinc-300 dark:border-zinc-700 dark:bg-zinc-800 dark:text-gray-300 focus:border-indigo-500 dark:focus:border-indigo-600 focus:ring-indigo-500 dark:focus:ring-indigo-600 rounded-md shadow-sm",children:[e("option",{value:"yes",children:n("Yes")}),e("option",{value:"no",children:n("No")})]}),e(p,{message:d.free_for_subs,className:"mt-2"})]})]}),a("div",{className:"mb-5",children:[e(c,{for:"thumbnail",value:n("Thumbnail")}),e(h,{className:"p-1 block w-full md:w-1/2 text-gray-900 border border-gray-300 rounded-lg cursor-pointer bg-gray-50 dark:text-gray-300 focus:outline-none dark:bg-zinc-800 dark:border-gray-600 dark:placeholder-zinc-900",type:"file",name:"thumbnail",handleChange:t=>_("thumbnail",t.target.files[0]),required:s.id===null}),e(p,{message:d.thumbnail,className:"mt-2"})]}),e("div",{className:"mb-5",children:a("label",{children:[e(Fe,{onChange:_e,checked:i.is_from_ftp}),"Select audio from FTP?"]})}),i.is_from_ftp?a("div",{className:"mt-2",children:[e(c,{value:n("Select FTP Audio File")}),e(C,{style:{width:"50%"},placeholder:n("Please select"),value:i.audio_file?i.audio_file.replace("audio/",""):void 0,onChange:fe,options:ie,required:!s.id}),e(p,{message:d.audio_file,className:"mt-2"})]}):a("div",{className:"mb-5",children:[e(c,{htmlFor:"audio_file",value:n("Upload Audio File")}),s.audio_file&&!g&&a("p",{className:"text-sm text-gray-500 mt-1",children:["Current file: ",s.audio_file.split("/").pop()]}),e(h,{className:"p-1 block w-full md:w-1/2 ...",type:"file",name:"audio_file_input",accept:"audio/mp3,audio/mpeg,audio/ogg",handleChange:he,required:!s.id&&!i.is_from_ftp}),e(p,{message:d.audio_file,className:"mt-2"}),g&&a("p",{className:"text-sm text-gray-500 mt-1",children:["New file selected: ",g.name]})]}),a("div",{className:"mb-5",children:[e(c,{for:"description_en",value:n("Description (English)")}),e(se,{name:"description_en",value:i.description_en||"",handleChange:t=>_("description_en",t.target.value),required:!0,className:"mt-1 block w-full md:w-1/2"}),e(p,{message:d.description_en,className:"mt-2"})]}),a("div",{className:"mb-5",children:[e(c,{htmlFor:"description_lang",value:n("Select Description Language")}),a("select",{name:"description_lang",value:i.description_lang,onChange:ue,className:"mt-1 block w-full md:w-1/2",children:[e("option",{value:"",children:n("--Select--")}),N.map(t=>e("option",{value:t.lang_value,children:t.lang_name},t.lang_value))]})]}),a("div",{className:"mb-5",children:[e(c,{htmlFor:"description_lang_val",value:`${(V=N.find(t=>t.lang_value===i.description_lang))==null?void 0:V.lang_name} ${n("Description")}`}),e(se,{name:"description_lang_val",value:i.description_lang_val,handleChange:m,className:"mt-1 block w-full md:w-1/2"})]}),e("hr",{className:"mt-3"}),e("label",{children:"SEO"}),a("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a("div",{children:[e(c,{for:"seo_h2",value:"H2"}),e(h,{name:"seo.h2",value:i.seo.h2,handleChange:m,className:"mt-1 block w-full"})]}),a("div",{children:[e(c,{for:"seo_keyword",value:"Keyword"}),e(h,{name:"seo.keyword",value:i.seo.keyword,handleChange:m,className:"mt-1 block w-full"})]}),a("div",{children:[e(c,{for:"seo_meta_keyword",value:"Meta Keyword"}),e(h,{name:"seo.meta_keyword",value:i.seo.meta_keyword,handleChange:m,className:"mt-1 block w-full"})]}),a("div",{children:[e(c,{for:"seo_desc",value:"Meta Description"}),e(h,{name:"seo.desc",value:i.seo.desc,handleChange:m,className:"mt-1 block w-full"})]}),a("div",{children:[e(c,{for:"seo_og_title",value:"OG Title"}),e(h,{name:"seo.og_title",value:i.seo.og_title,handleChange:m,className:"mt-1 block w-full"})]}),a("div",{children:[e(c,{for:"seo_og_desc",value:"OG Description"}),e(h,{name:"seo.og_desc",value:i.seo.og_desc,handleChange:m,className:"mt-1 block w-full"})]}),a("div",{children:[e(c,{for:"seo_meta_robot",value:"Meta Robot"}),e(h,{name:"seo.meta_robot",value:i.seo.meta_robot,handleChange:m,className:"mt-1 block w-full"})]}),a("div",{children:[e(c,{for:"seo_cust_url",value:"Custom URL"}),e(h,{name:"seo.cust_url",value:i.seo.cust_url,handleChange:m,className:"mt-1 block w-full"})]}),a("div",{children:[e(c,{for:"seo_og_image_url",value:"OG Image URL"}),e(h,{name:"seo.og_image_url",value:i.seo.og_image_url,handleChange:m,className:"mt-1 block w-full"})]}),a("div",{children:[e(c,{for:"seo_json_id",value:"JSON ID"}),e(h,{name:"seo.json_id",value:i.seo.json_id,handleChange:m,className:"mt-1 block w-full"})]})]}),a("div",{className:"mt-4",children:[e(S,{name:"is_terms",checked:i.is_terms,handleChange:m}),a("span",{className:"mx-2",children:[n(" Agree to "),e("a",{href:"policy/Terms.pdf",className:"underline",target:"_blank",children:n("Terms and Conditions")})]}),e(p,{message:d.is_terms,className:"mt-2"})]}),a("div",{className:"mt-4",children:[e(S,{name:"is_agreement",checked:i.is_agreement,handleChange:m}),a("span",{className:"mx-2",children:[n(" Agree to "),e("a",{href:"policy/Streamer-Agreement.pdf",className:"underline",target:"_blank",children:n("Agreement")})]}),e(p,{message:d.is_agreement,className:"mt-2"})]}),a("div",{className:"mt-4",children:[e(S,{name:"is_rules",checked:i.is_rules,handleChange:m}),a("span",{className:"mx-2",children:[n(" Agree to "),e("a",{href:"policy/Content-Rules.pdf",className:"underline",target:"_blank",children:n("Rules")})]}),e(p,{message:d.is_rules,className:"mt-2"})]}),e("div",{className:"mt-5",children:e(te,{type:"submit",processing:A,disabled:A,children:s.id===null?n("Upload"):n("Save Changes")})})]})]})]})]})}export{ls as default};
