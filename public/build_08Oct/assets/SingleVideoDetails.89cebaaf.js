import{u as k,a as e,j as s,H as S,r as n,d as w,F,L as u,h as I}from"./app.b55b7b24.js";import{A as ee}from"./AuthenticatedLayout.add8c7e1.js";import{_ as o}from"./Translate.dc83ae5b.js";import{a as te,b as re,c as ae,d as se,e as ne,g as le}from"./index.d226c3dd.js";import{a as ie}from"./index.ec42c783.js";import{S as oe}from"./Spinner.f7051ff4.js";import{P as ce}from"./PrimaryButton.cd9ccef6.js";import"./react-toastify.esm.b0778105.js";import{C as me}from"./index.esm.33c290c5.js";import{M as de,c as pe}from"./index.ed62628f.js";import{j as ue}from"./index.81cb27cb.js";import{S as xe}from"./SecondaryButton.fb585d7e.js";import"./react-cookie-consent.esm.c359df54.js";import{M as he}from"./Modal.16eb4526.js";import ge from"./ShareLink.f171a592.js";import"./TextInput.60bd8868.js";import{T as fe}from"./TokenPurchasePopup.7d8f49fa.js";import ye from"./SubscribePopup.29d1ad92.js";import"./Textarea.f039ae49.js";import{V as we}from"./VideosLoop.2a86afcb.js";import{P as be}from"./index.23fd716c.js";/* empty css             */import{A as Ne}from"./AdBar.75efc618.js";import"./Front.204303ed.js";import"./iconBase.c9d6e0f8.js";import"./index.aece37d8.js";import"./index.e7e076b2.js";import"./index.esm.6c6b8a7f.js";import"./transition.b14c266a.js";import"./index.fb6a6077.js";import"./index.fa3a0e35.js";import"./react-tooltip.min.bbf5e269.js";/* empty css                          */import"./Loader.ab3ad1ff.js";import"./InputLabel.86be1c48.js";import"./InputError.5d984c18.js";import"./index.517f43d0.js";const T=({video:t,relatedvideos:c,url:x,inModal:h,seo:r,authUser:m})=>{var V,U,B,z,E;console.log("\u{1F680} SingleVideoDetails props",{video:t,relatedvideos:c,url:x,authUser:m});const[g,d]=n.exports.useState(!1);n.exports.useState();const[p,f]=n.exports.useState(!1),[l,_]=n.exports.useState(!1);n.exports.useState(!1);const[A,v]=n.exports.useState(t.isUserFavorite),[j,N]=n.exports.useState(null),[C,D]=n.exports.useState(!1),{props:b}=k(),[G,M]=n.exports.useState(!1),[P,H]=n.exports.useState(""),O=((V=b.auth)==null?void 0:V.user)!==null,$=t.canBePlayed;n.exports.useState(!1),n.exports.useState(!1),n.exports.useEffect(()=>{X(),b.popupMessage&&(H(b.popupMessage),M(!0))},[b.popupMessage]),S,t.title,r!=null&&r.meta_keyword,r!=null&&r.desc,r!=null&&r.meta_robot,r!=null&&r.og_title||t.title,r!=null&&r.og_desc,r!=null&&r.og_image_url,r!=null&&r.cust_url,r!=null&&r.json_id&&JSON.stringify({"@context":"https://schema.org","@type":"VideoObject",identifier:r==null?void 0:r.json_id,name:(r==null?void 0:r.og_title)||t.title,description:(r==null?void 0:r.desc)||"",thumbnailUrl:(r==null?void 0:r.og_image_url)||"",uploadDate:t.uploadDate||"",contentUrl:window.location.href});const[L,q]=n.exports.useState(""),J=async()=>{D(!0),N(null);try{console.log("Download request started...");const a=await w.post(route("video.download"),{slug:t.slug});if(a.data.status===1){q("Download will start in sometime...please wait.");const i=a.data.link;console.log("Download URL:",i);const Z=await(await fetch(i)).blob(),R=window.URL.createObjectURL(Z),y=document.createElement("a");y.href=R,y.setAttribute("download",`${t.slug}.mp4`),document.body.appendChild(y),y.click(),document.body.removeChild(y),window.URL.revokeObjectURL(R)}else N(a.data.message)}catch(a){console.error("Download error:",a),N("An error occurred while downloading the video.")}finally{D(!1)}},W=(a,i)=>{a.preventDefault(),f(i),_(!0)},K=()=>{v(!0),w.post(route("video.addToFavorite",{id:t.id}))},Q=()=>{v(!1),w.post(route("video.removeFromFavorite",{id:t.id}))},X=()=>{w.post(route("video.increaseViews",{video:t.id})).then(()=>{d(!0)}).catch(a=>{console.error("Error increasing views:",a)})};n.exports.useRef(null);const Y={type:"video",autoplay:!0,sources:[{src:t.videoUrl,type:"video/mp4",size:720},{src:(U=t.videoUrl360p)!=null?U:t.videoUrl,type:"video/mp4",size:360}]};return s(F,{children:[e(he,{show:l,onClose:a=>_(!1),children:p&&e(ge,{link:p,inModal:!0})}),P&&G&&e("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s("div",{className:"bg-white px-8 pt-12 pb-12 rounded-lg shadow-lg max-w-xl w-full text-center min-h-[400px] min-w-[800px] flex flex-col justify-center relative",children:[e("button",{onClick:()=>{M(!1),window.location.href="/"},className:"absolute top-4 right-4 text-gray-600 hover:text-black text-2xl font-bold","aria-label":"Close",children:"\xD7"}),e("h2",{className:"text-2xl font-bold mb-6",children:"Notice"}),e("p",{className:"mb-8 text-lg",children:P}),e(u,{href:route("token.packages"),className:"inline-block bg-blue-600 text-white px-6 py-3 rounded hover:bg-blue-700 font-semibold text-lg mx-auto",children:"Purchase Token Packs"})]})}),s("div",{className:`justify-center w-full ${h?"p-3":"p-0"}`,children:[s("div",{className:"flex items-start",children:[e("div",{className:"mr-5 flex flex-col items-center flex-shrink-0",children:e(u,{href:route("channel",{user:t.streamer.username}),children:e("img",{src:t.streamer.profile_picture,className:"w-14 h-14 rounded-full"})})}),s("div",{children:[e("h1",{className:"text-lg md:text-2xl font-light dark:text-indigo-100 hover:text-indigo-800 text-indigo-600 dark:hover:text-indigo-400",children:t.title}),s("div",{className:"flex items-center flex-wrap md:space-x-2 mt-1",children:[s(u,{href:route("channel",{user:t.streamer.username}),className:"text-sm text-gray-600 mr-2  dark:text-white",children:["@",t.streamer.username]}),(B=t.selectedCategory)==null?void 0:B.map((a,i)=>s(u,{href:route("videos.browse",{videocategory:a.value,slug:`-${a.label}`}),className:"text-gray-600 mr-2  inline-flex items-center space-x-1 dark:text-zinc-100 text-sm",children:[e(te,{className:"w-3"}),e("span",{children:a.label})]})),e(re,{className:"w-3"}),e("span",{children:(z=t==null?void 0:t.tags)==null?void 0:z.map((a,i)=>s(u,{href:route("tag",{id:a.id}),className:"text-gray-600 mr-2  inline-flex items-center space-x-1 dark:text-zinc-100 text-sm",children:[" ",s("span",{children:[a.name," ",i!==t.tags.length-1&&", "]})]}))}),s("div",{className:"text-gray-600 mr-2 inline-flex items-center space-x-1 dark:text-zinc-100 text-sm",children:[e(me,{className:"w-3"}),(E=t==null?void 0:t.modelDetails)==null?void 0:E.map((a,i)=>e(u,{href:route("model",{id:a.slug}),className:"text-gray-600 mr-2 inline-flex items-center space-x-1 dark:text-zinc-100 text-sm",children:s("span",{children:[a.name," ",i!==t.modelDetails.length-1&&", "]})},a.slug))]}),t.free_for_subs==="yes"&&t.price!==0&&s("div",{className:"mt-1 md:mt-0 inline-flex items-center text-sm bg-gray-100 rounded px-2 py-1 text-gray-500 dark:text-gray-600",children:[e(ue,{className:"w-4 h-4 mr-1"}),o("Free For Subscribers")]}),t.canDownload&&e("div",{className:"mt-1 md:mt-0 inline-flex items-center text-sm bg-gray-100 rounded px-2 py-1 text-gray-500 dark:text-gray-600",children:e("button",{onClick:J,className:"relative flex items-center justify-center",disabled:C,children:C?e("span",{className:"loader"}):o("Download")})}),L&&e("p",{className:"text-gray-600 mt-2 text-sm",children:L}),j&&e("p",{className:"text-red-500",children:j}),e("div",{className:"mt-1 md:mt-0 inline-flex items-center text-sm bg-gray-100 rounded px-2 py-1 text-gray-500 dark:text-gray-600",children:s("span",{children:[" ",o("Duration ")," : ",t.duration.minute]})}),e("div",{className:"mt-1 md:mt-0 inline-flex items-center text-sm bg-gray-100 rounded px-2 py-1 text-gray-500 dark:text-gray-600",children:s("span",{children:[" ",o("Resolution ")," : ",t.duration.resolution]})}),s("div",{className:"mt-1 md:mt-0 inline-flex items-center text-sm bg-gray-100 rounded px-2 py-1 text-gray-500 dark:text-gray-600 cursor-pointer",onClick:a=>W(a,document.URL),children:[e(ae,{className:"w-4 h-4 mr-1"}),o("Share ")]}),e("div",{className:"mt-1 md:mt-0 inline-flex items-center text-sm bg-gray-100 rounded px-2 py-1 text-gray-500 dark:text-gray-600",children:e(ye,{user:t.streamer,userIsSubscribed:t.isCurrentSubscriber})}),A?e("div",{className:"mt-1 md:mt-0 inline-flex items-center text-sm rounded px-2 py-1 cursor-pointer",onClick:a=>Q(),children:e(se,{style:{color:"red"},className:"w-4 h-4 mr-1"})}):s(F,{children:[e("div",{className:"mt-1 md:mt-0 inline-flex items-center text-sm rounded px-2 py-1 cursor-pointer",onClick:a=>K(),children:e(ne,{style:{color:"red"},className:"w-4 h-4 mr-1"})}),s("div",{className:"mt-1 md:mt-0 inline-flex items-center text-sm rounded px-2 py-1 cursor-pointer",children:[e(le,{style:{color:"red"},className:"w-4 h-4 mr-1"}),e("span",{children:t==null?void 0:t.views})]})]}),!t.canBePlayed&&s("div",{className:"mt-1 md:mt-0 inline-flex items-center text-sm bg-yellow-300 rounded px-2 py-1 text-gray-500 dark:text-gray-600 cursor-pointer",onClick:a=>I.Inertia.visit(route("video.unlock",{video:t.id})),children:[e(de,{className:"w-4 h-4 mr-1"}),o("Unlock with :tokens tokens",{tokens:t.price})]})]})]})]}),e("div",{className:"mt-5",children:O?$?e(be,{source:Y}):s("div",{className:"flex flex-col items-center justify-center",children:[e("img",{src:t.videoGIF,className:"hovered-gif rounded-tl-lg rounded-tr-lg mb-3",alt:"GIF Preview",onError:a=>{a.target.onerror=null,a.target.src="/default-thumbnail.jpg"}}),e("div",{className:"mt-5 text-center",children:t.price>0&&s(ce,{className:"mt-3",onClick:()=>I.Inertia.visit(route("video.unlock",{video:t.id})),children:["Unlock with ",t.price," Tokens"]})})]}):s("div",{className:"flex flex-col items-center justify-center",children:[e("img",{src:t.videoGIF,className:"hovered-gif rounded-tl-lg rounded-tr-lg mb-3",alt:"GIF Preview",onError:a=>{a.target.onerror=null,a.target.src="/default-thumbnail.jpg"}}),e("div",{className:"mt-5 text-center",children:e(u,{href:route("login"),className:"bg-violet-600 p-1.5 rounded-lg border-violet-600 font-semibold px-4 text-zinc-200 hover:bg-violet-500",children:"Login For Watch Full Video"})})]})}),e("h2",{className:"mt-5 dark:text-indigo-100 hover:text-indigo-800 text-indigo-600 dark:hover:text-indigo-400",children:t.description?t.description:""}),e("div",{className:"mt-3 flex justify-center items-center",children:e(Ne,{})})]})]})},ke=({relatedvideos:t,userLoginID:c})=>{const[x,h]=n.exports.useState(""),[r,m]=n.exports.useState(!1),[g,d]=n.exports.useState("");n.exports.useEffect(()=>{d(t.data),h(t.next_page_url)},[]);const p=async f=>{m(!0);try{const l=await w.get(f);d([...g,...l.data.data]),h(l.data.next_page_url),m(!1)}catch(l){console.log(l)}};return s("div",{children:[s("div",{className:"flex justify-start items-center mt-20 mb-8",children:[e(pe,{className:"text-pink-600 text-4xl mr-1"}),e("h2",{className:"text-indigo-900 text-center dark:text-zinc-200 text-4xl font-semibold",children:o("Related Videos")})]}),s("div",{className:"mt-5 mb-5",children:[t.total===0&&s("div",{className:"text-xl bg-white rounded-lg shadow text-gray-600 dark:bg-zinc-900 dark:text-white font-light p-3 flex items-center",children:[e(ie,{className:"w-12 h-12 mr-2"}),o("No videos to show")]}),g.length>0&&e(we,{videos:g,userLoginID:c}),t.last_page>1&&e(F,{children:r?e("div",{className:"my-3",children:e(oe,{})}):e(xe,{className:"mt-2",processing:!t.next_page_url,onClick:()=>p(x),children:o("Load More")})})]})]})};function it({video:t,relatedvideos:c,url:x,userLoginID:h,inModal:r=!1,authUser:m}){var d,p;const{props:g}=k();if(g.auth.user,console.log("SingleVideo rendered with inModal:",r),r)return e(T,{video:t,relatedvideos:c,url:x,inModal:!0,authUser:m});{const{props:f}=k(),l=(d=f.auth)==null?void 0:d.user;return t.seoDetails,s(ee,{children:[e(S,{title:t.title}),e(T,{video:t,relatedvideos:c,url:x,inModal:!1,authUser:m}),e(ke,{relatedvideos:c,userLoginID:h}),l&&(l==null?void 0:l.tokens)<=20&&e(fe,{}),e(S,{title:t.title,children:e("meta",{name:"description",content:(p=t.description)==null?void 0:p.slice(0,160)})})]})}}export{it as default};
