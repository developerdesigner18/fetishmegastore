import{I as n}from"./InputLabel.86be1c48.js";import{I as o}from"./InputError.5d984c18.js";import{T as _}from"./TextInput.60bd8868.js";import{T as q}from"./Textarea.f039ae49.js";import{P as D}from"./PrimaryButton.cd9ccef6.js";import{_ as t}from"./Translate.dc83ae5b.js";import{Q as b}from"./react-toastify.esm.b0778105.js";import{A as K}from"./AuthenticatedLayout.add8c7e1.js";import{i as W,r as c,d as X,j as r,a as e,H as Z,h as F}from"./app.b55b7b24.js";import{c as ee}from"./index.ed62628f.js";import ae from"./AccountNavi.f5fdb992.js";import{S as k}from"./sweetalert2.esm.all.08ba7c87.js";import{C as S}from"./Checkbox.922d0b21.js";import{S as C}from"./Front.204303ed.js";import{S as se}from"./index.24c48f30.js";import"./index.aece37d8.js";import"./iconBase.c9d6e0f8.js";import"./index.d226c3dd.js";import"./react-cookie-consent.esm.c359df54.js";import"./transition.b14c266a.js";import"./Modal.16eb4526.js";import"./index.e7e076b2.js";import"./index.esm.6c6b8a7f.js";function Ae({textFile:s,categories:M,models:E,tags:U,fileNames:j}){const{data:l,setData:m,post:x,processing:P,errors:i,progress:te}=W({title_en:s.title_en||"",title_de:s.title_de||"",tag:s.tag||"",description_en:s.description_en||"",description_de:s.description_de||"",category_id:s.category_id||"",model_id:s.model_id||"",price:s.price||"",free_for_subs:s.free_for_subs||!1,is_from_ftp:s.is_from_ftp||!1,thumbnail:"",text_file:"",is_terms:typeof s.is_terms=="boolean"?s.is_terms:!1,is_agreement:typeof s.is_agreement=="boolean"?s.is_agreement:!1,is_rules:typeof s.is_rules=="boolean"?s.is_rules:!1}),[u,z]=c.exports.useState(null),[f,y]=c.exports.useState([]),[re,N]=c.exports.useState(!1),[I,w]=c.exports.useState(0),[p,B]=c.exports.useState(s.is_from_ftp===1),[le,$]=c.exports.useState(s.category_id||""),[ie,V]=c.exports.useState(s.model_id||""),Y=()=>{B(!p),l.is_from_ftp=p!==!0};c.exports.useEffect(()=>{s&&(m("description_en",s.description_en||""),m("description_de",s.description_de||""),$(s.category_id),V(s.model_id))},[s]);const H=a=>{console.log(`selected ${a}`),z(a),l.text_file="textFile/"+a,l.is_from_ftp=p},R=a=>{console.log(`selected tag ${a}`),l.tag=a},G=a=>{console.log(`selected category ${a}`),l.category_id=a},L=a=>{console.log(`selected model ${a}`),l.model_id=a},g=a=>{m(a.target.name,a.target.type==="checkbox"?a.target.checked:a.target.value)};c.exports.useEffect(()=>{Object.keys(i).length&&Object.keys(i).forEach(a=>{b.error(i[a])})},[i]),c.exports.useEffect(()=>{f.length>0&&Q()},[f]);const O=()=>{y([]);let a=1024*1024*8,h=Math.ceil(u.size/a);for(let d=0;d<h;d++)y(v=>[...v,u.slice(d*a,Math.min(d*a+a,u.size),u.type)])},Q=()=>{N(!0);const a=new FormData;a.append("media_type","textFile"),a.append("is_last",f.length===1),a.append("textFile",s.id||0),a.set("file",f[0],`${u.name}.part`),X.post(route("textFile.uploadChunks"),a,{onUploadProgress:h=>{w(I+h.loaded)}}).then(function(h){f.length<=1&&(y([]),w(0),l.text_file=h.data.result,s.id===null?A():T());let d=[...f];d.splice(0,1),y(d)}).catch(function(h){var d,v;w(0),b.error((v=(d=h.response)==null?void 0:d.data)==null?void 0:v.message)}).then(function(){N(!1)})},A=()=>{k.fire({title:"Are you sure?",text:"Do you want to save this textFile?",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, save it!",cancelButtonText:"No, cancel"}).then(a=>{a.isConfirmed?(x(route("textFile.saveTextFile")),k.fire("Saved!","Your textFile has been saved.","success")):a.dismiss===k.DismissReason.cancel&&k.fire("Cancelled","Your textFile has not been saved","error")})},T=()=>{x(route("textFile.update",{textFile:s.id}))},J=a=>{if(a.preventDefault(),!l.is_terms){b.error(t("Please agree to terms and conditions"));return}if(!l.is_agreement){b.error(t("Please agree to the agreement"));return}if(!l.is_rules){b.error(t("Please agree to the rules"));return}u?p?(N(!0),s.id===null?A():T(),N(!1)):O():u===""&&s.id!==null&&(p?x(route("textFile.update",{textFile:s.id})):T())};return r(K,{children:[e(Z,{title:t("Upload TextFile")}),r("div",{className:"lg:flex lg:space-x-10",children:[e(ae,{active:"upload-textFile"}),r("div",{className:"p-4 sm:p-8 bg-white w-full dark:bg-zinc-900 shadow sm:rounded-lg",children:[r("header",{className:"mb-5",children:[r("h2",{className:"text-lg inline-flex items-center md:text-xl font-medium text-gray-600 dark:text-gray-100",children:[e(ee,{className:"mr-2"}),s.id===null?t("Upload TextFile"):t("Edit TextFile")]}),e("p",{className:"mt-1 mb-2 text-sm text-gray-600 dark:text-gray-400",children:t("Upload a new TextFile")}),e(D,{onClick:a=>F.Inertia.visit(route("textFile.list")),children:t("<< Back to TextFile")})]}),e("hr",{className:"my-5"}),r("form",{onSubmit:J,encType:"multipart/form-data",children:[r("div",{className:"mb-5",children:[e(n,{for:"title_en",value:t("Title")}),e(_,{name:"title_en",value:l.title_en||s.title_en||s.title||"",handleChange:a=>m("title_en",a.target.value),required:!0,className:"mt-1 block w-full md:w-1/2"}),e(o,{message:i.title_en,className:"mt-2"})]}),r("div",{className:"mb-5",children:[e(n,{for:"title_de",value:t("German Title")}),e(_,{name:"title_de",value:l.title_de||s.title_de||"",handleChange:a=>m("title_de",a.target.value),required:!0,className:"mt-1 block w-full md:w-1/2"}),e(o,{message:i.title_de,className:"mt-2"})]}),r("div",{className:"mb-5",children:[e(n,{for:"category",value:t("Category")}),e(C,{mode:"multiple",allowClear:!0,showSearch:!0,style:{width:"50%"},placeholder:"Please select",defaultValue:l.category_id==""?[]:s.selectedCategory,onChange:G,options:M}),e(o,{message:i.category_id,className:"mt-2"})]}),r("div",{className:"mb-5",children:[e(n,{for:"model",value:t("Model")}),e(C,{mode:"multiple",allowClear:!0,showSearch:!0,style:{width:"50%"},placeholder:"Please select",defaultValue:l.model_id===null?[]:s.selectedModel,onChange:L,options:E}),e(o,{message:i.model_id,className:"mt-2"})]}),r("div",{className:"mb-5",children:[e(n,{for:"tag",value:t("Tags")}),e(C,{mode:"multiple",allowClear:!0,showSearch:!0,style:{width:"50%"},placeholder:"Please select",defaultValue:l.tag===null?[]:s.tags,onChange:R,options:U}),e(o,{message:i.tag,className:"mt-2"})]}),r("div",{className:"flex w-full md:w-1/2 flex-col md:flex-row md:items-center md:space-x-10 md:justify-between",children:[r("div",{className:"mb-5",children:[e(n,{for:"price",value:t("Price")}),r("div",{className:"flex items-center",children:[e(_,{type:"number",name:"price",value:l.price,handleChange:g,required:!0,className:"mt-1 w-32"}),e("div",{className:"ml-1 dark:text-white text-gray-700",children:t("tokens")})]}),e(o,{message:i.price,className:"mt-2"})]}),r("div",{className:"mb-5",children:[e(n,{for:"free_for_subs",value:t("Free for subscribers?")}),r("select",{name:"free_for_subs",value:l.free_for_subs,onChange:g,required:!0,className:"mt-1 block w-32 border-zinc-300 dark:border-zinc-700 dark:bg-zinc-800 dark:text-gray-300 focus:border-indigo-500 dark:focus:border-indigo-600 focus:ring-indigo-500 dark:focus:ring-indigo-600 rounded-md shadow-sm",children:[e("option",{value:"yes",children:t("Yes")}),e("option",{value:"no",children:t("No")})]}),e(o,{message:i.free_for_subs,className:"mt-2"})]})]}),r("div",{className:"mb-5",children:[e(n,{for:"thumbnail",value:t("Thumbnail")}),e(_,{className:"p-1 block w-full md:w-1/2 text-gray-900 border border-gray-300 rounded-lg cursor-pointer bg-gray-50 dark:text-gray-300 focus:outline-none dark:bg-zinc-800 dark:border-gray-600 dark:placeholder-zinc-900",type:"file",name:"thumbnail",handleChange:a=>m("thumbnail",a.target.files[0]),required:s.id===null}),e(o,{message:i.thumbnail,className:"mt-2"})]}),e("div",{className:"mb-5",children:r("label",{children:[e(se,{onChange:Y,checked:l.is_from_ftp}),"Select textFile from FTP?"]})}),!p&&r("div",{className:"mb-5",children:[e(n,{for:"textFile",value:t("Text File")}),e(_,{className:"p-1 block w-full md:w-1/2 text-gray-900 border border-gray-300 rounded-lg cursor-pointer bg-gray-50 dark:text-gray-300 focus:outline-none dark:bg-zinc-800 dark:border-gray-600 dark:placeholder-zinc-900",type:"file",name:"textFile_file",accept:"pdf,doc,docx,txt",handleChange:a=>z(a.target.files[0]),required:s.id===null}),e(o,{message:i.textFile_file,className:"mt-2"})]}),p&&e("div",{className:"mt-2",children:e(C,{style:{width:"50%"},placeholder:"Please select",value:s.textFile_file,onChange:H,options:j})}),r("div",{className:"mb-5",children:[e(n,{for:"description_en",value:t("Description (English)")}),e(q,{name:"description_en",value:l.description_en||"",handleChange:a=>m("description_en",a.target.value),required:!0,className:"mt-1 block w-full md:w-1/2"}),e(o,{message:i.description_en,className:"mt-2"})]}),r("div",{className:"mb-5",children:[e(n,{for:"description_de",value:t("Description (German)")}),e(q,{name:"description_de",value:l.description_de||"",handleChange:a=>m("description_de",a.target.value),required:!0,className:"mt-1 block w-full md:w-1/2"}),e(o,{message:i.description_de,className:"mt-2"})]}),r("div",{className:"mt-4",children:[e(S,{name:"is_terms",checked:l.is_terms,handleChange:g}),r("span",{className:"mx-2",children:[t(" Agree to "),e("a",{href:"policy/Terms.pdf",className:"underline",target:"_blank",children:t("Terms and Conditions")})]}),e(o,{message:i.is_terms,className:"mt-2"})]}),r("div",{className:"mt-4",children:[e(S,{name:"is_agreement",checked:l.is_agreement,handleChange:g}),r("span",{className:"mx-2",children:[t(" Agree to "),e("a",{href:"policy/Streamer-Agreement.pdf",className:"underline",target:"_blank",children:t("Agreement")})]}),e(o,{message:i.is_agreement,className:"mt-2"})]}),r("div",{className:"mt-4",children:[e(S,{name:"is_rules",checked:l.is_rules,handleChange:g}),r("span",{className:"mx-2",children:[t(" Agree to "),e("a",{href:"policy/Content-Rules.pdf",className:"underline",target:"_blank",children:t("Rules")})]}),e(o,{message:i.is_rules,className:"mt-2"})]}),e("div",{className:"mt-5",children:e(D,{type:"submit",processing:P,disabled:P,children:s.id===null?t("Upload"):t("Save Changes")})})]})]})]})]})}export{Ae as default};
