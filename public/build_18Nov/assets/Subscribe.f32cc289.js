import{_ as r}from"./Translate.dc83ae5b.js";import{u as Y,r as c,j as t,a as e,H as B,L as M,F as L,h as C,d as P}from"./app.64d592ef.js";import{A as O}from"./AuthenticatedLayout.fa68427b.js";import{M as g}from"./index.aca621cc.js";import{S as _}from"./Spinner.507e754f.js";import{l as $,E as I,u as z,a as A,C as j}from"./react-stripe.esm.59c927a7.js";import"./Front.fbff2f23.js";import"./iconBase.9b35345f.js";import"./index.6e860bb5.js";import"./index.6369b7cd.js";import"./react-cookie-consent.esm.c9f68579.js";import"./transition.cfd51e90.js";import"./Modal.81054d6f.js";import"./react-toastify.esm.06aebf17.js";import"./TextInput.618a5da3.js";import"./index.e7e076b2.js";import"./index.esm.7bfaeba6.js";import"./index.517f43d0.js";const D=({isOpen:n,closeModal:s,userName:x})=>{const y=z(),k=A(),[p,m]=c.exports.useState(!1),[u,d]=c.exports.useState(""),a=async f=>{f.preventDefault(),m(!0);try{const{data:b}=await P.post("/payment/setup-intent"),h=b.clientSecret,l=k.getElement(j),{error:o,setupIntent:w}=await y.confirmCardSetup(h,{payment_method:{card:l,billing_details:{name:x}}});o?(d(o.message),m(!1)):(await P.post("/payment/save-payment-method",{payment_method:w.payment_method}),s(),window.location.reload(!0))}catch{d("An error occurred, please try again."),m(!1)}};return n?e("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-80 flex items-center justify-center z-50",children:t("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-md p-6 md:p-8 relative",children:[t("div",{className:"flex justify-between items-center mb-6",children:[e("h2",{className:"text-2xl font-semibold text-gray-800",children:r("Connect Your Card")}),e("button",{className:"text-gray-400 hover:text-gray-600 transition-colors",onClick:s,children:e("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),t("form",{onSubmit:a,children:[e("div",{className:"p-4 bg-gray-50 border border-gray-300 rounded-md",children:e(j,{className:"p-3"})}),u&&e("div",{className:"text-red-500 text-sm mt-2",children:u}),e("div",{className:"mt-6",children:e("button",{type:"submit",className:`w-full py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-md transition-all ${p?"opacity-75":""}`,disabled:!y||p,children:p?"Processing...":"Save Card"})})]}),e("button",{className:"w-full mt-4 py-3 bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold rounded-md transition-all",onClick:s,children:"Cancel"})]})}):null};function ne({channel:n,tier:s,publicKey:x,tokenPack:y,paypalImg:k,paymentMethod:p,isPaypal:m}){const u=$(x),{auth:d}=Y().props,[a,f]=c.exports.useState("Monthly"),[b,h]=c.exports.useState(s.price),[l,o]=c.exports.useState(!1),[w,S]=c.exports.useState(!1),v=i=>{switch(f(i),i){case"6 Months":h(s.SixMonthsPrice);break;case"Monthly":h(s.price);break;case"Yearly":h(s.YearlyPrice);break}},F=i=>{i.preventDefault(),C.Inertia.visit(route("confirm-subscription",{user:n.id,tier:s.id,plan:a}),{onBefore:N=>{o(!0)},onFinish:N=>{o(!1)}})},E=i=>{i.preventDefault(),C.Inertia.visit(route("paypal.purchaseSubscription",{user:n.id,tier:s.id,plan:a}),{onBefore:N=>{o(!0)},onFinish:N=>{o(!1)}})};return t(O,{children:[e(B,{title:r("Subscribe to :channel",{channel:n.username})}),e("div",{className:"ml-0",children:t("div",{className:"p-4 sm:p-8 bg-gray-100 dark:bg-zinc-900 shadow sm:rounded-lg",children:[t("header",{children:[t("div",{className:"justify-center flex items-center space-x-2 flex-wrap",children:[e("div",{children:e(M,{href:route("channel",{user:n.username}),children:e("img",{src:n.profile_picture,alt:"",className:"rounded-full h-14 border-zinc-200 dark:border-indigo-200 border"})})}),t("div",{children:[e(M,{href:route("channel",{user:n.username}),children:e("h2",{className:"text-center text-2xl font-medium text-gray-800 dark:text-gray-100",children:r("Subscribe to @:channel",{channel:n.username})})}),e("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400 text-center",children:r("Select subscription length & payment method")})]})]}),t("div",{className:"flex flex-col md:flex-row md:justify-around items-center mt-10 space-y-5 md:space-y-0",children:[t("button",{onClick:i=>v("6 Months"),className:`relative w-52 rounded-lg p-3 shadow ${a==="6 Months"?"bg-indigo-600 text-white":"bg-white text-gray-800"}`,children:[e("div",{className:"absolute inline-flex items-center justify-center px-1.5 py-1 text-xs font-bold text-white bg-pink-500 rounded-full -top-2 right-0",children:r(":discount% OFF",{discount:s.six_months_discount})}),r("6 Months")]}),e("button",{onClick:i=>v("Monthly"),className:`w-52 rounded-lg p-3 shadow ${a==="Monthly"?"bg-indigo-600 text-white":"bg-white text-gray-800"}`,children:r("1 Month")}),t("button",{onClick:i=>v("Yearly"),className:`relative w-52 rounded-lg p-3 shadow ${a==="Yearly"?"bg-indigo-600 text-white":"bg-white text-gray-800"}`,children:[e("div",{className:"absolute inline-flex items-center justify-center px-1.5 py-1 text-xs font-bold text-white bg-pink-500 rounded-full -top-2 right-0",children:r(":discount% OFF",{discount:s.one_year_discount})}),r("1 Year")]})]})]}),t("div",{className:"border-t pt-5 text-xl text-center font-light mt-8 dark:text-white",children:[t("p",{className:"bg-white shadow text-gray-800 font-semibold inline-flex rounded-lg p-2",children:[e(g,{className:"h-6 w-6"})," ",r("Price: :price $",{price:b})]}),e("br",{}),e("div",{className:"mt-5 border-t pt-5",children:d.user.stripe_customer_id&&d.user.default_payment_method?t(L,{children:[t("button",{onClick:i=>F(i),className:"py-2 px-3 mt-2 mb-3 inline-flex rounded-md items-center bg-pink-500 text-white font-semibold hover:bg-pink-600 disabled:bg-gray-300 disabled:text-gray-700",disabled:l,children:[e(g,{className:"h-6 w-6 mr-2"}),e("div",{children:r("Subscription By Card")})]}),l&&e("center",{children:e(_,{})})]}):t("div",{className:"text-gray-700 dark:text-white text-base",children:[r("You need to connect your card first"),e("br",{}),t("button",{className:"py-1.5 px-3 mt-2 inline-flex border-2 rounded-md hover:border-gray-700 hover:text-gray-700 items-center border-indigo-600 text-indigo-600 dark:border-white dark:text-white dark:hover:border-indigo-200 dark:hover:text-indigo-200",onClick:()=>S(!0),children:[e(g,{className:"h-6 w-6 mr-2"}),e("div",{children:r("Subscription By Card")})]})]})}),e("div",{className:"mt-5",children:m&&t("div",{className:"mt-5",children:[t("button",{onClick:i=>E(i),className:"py-2 px-3 mt-2 mb-3 inline-flex rounded-md items-center bg-pink-500 text-white font-semibold hover:bg-pink-600 disabled:bg-gray-300 disabled:text-gray-700",disabled:l,children:[e(g,{className:"h-6 w-6 mr-2"}),e("div",{children:r("Subscription By PayPal")})]}),l&&e("center",{children:e(_,{})})]})})]})]})}),e(I,{stripe:u,children:e(D,{isOpen:w,closeModal:()=>S(!1),userName:d.user.username})})]})}export{ne as default};
