import{I as d}from"./InputLabel.4e4122f6.js";import{I as p}from"./InputError.e1768fe1.js";import{T as f}from"./TextInput.618a5da3.js";import{T as Q}from"./Textarea.8137cc1e.js";import{P as W}from"./PrimaryButton.dc200cb7.js";import{_ as s}from"./Translate.dc83ae5b.js";import{Q as C}from"./react-toastify.esm.06aebf17.js";import{A as fe}from"./AuthenticatedLayout.fa68427b.js";import{i as _e,r as g,d as we,j as l,a,H as ve,h as be,F as G}from"./app.64d592ef.js";import{S as ye}from"./Spinner.507e754f.js";import{c as ke}from"./index.aca621cc.js";import Ne from"./AccountNavi.c0aead7d.js";import{S as w}from"./sweetalert2.esm.all.08ba7c87.js";import{C as F}from"./Checkbox.2bde8e20.js";import{S as x}from"./Front.fbff2f23.js";import"./index.6e860bb5.js";import"./iconBase.9b35345f.js";import"./index.6369b7cd.js";import"./react-cookie-consent.esm.c9f68579.js";import"./transition.cfd51e90.js";import"./Modal.81054d6f.js";import"./index.e7e076b2.js";import"./index.esm.7bfaeba6.js";function Ge({video:t,ogValue:i,categories:J,fileNames:X,tags:Z,models:V,systemVideo:ee,isEdit:A,supportedLocales:u}){var I,M,O,q,j,L,Y,E,H,R;console.log("preview deatils",t);const{data:r,setData:b,post:y,processing:ae,errors:m,progress:T}=_e({title_en_val:((I=i==null?void 0:i.title)==null?void 0:I.en)||"",title_lang:(i==null?void 0:i.title_lang)||"",title_de:((M=i==null?void 0:i.title)==null?void 0:M[i==null?void 0:i.title_lang])||"",description_en_val:((O=i==null?void 0:i.description)==null?void 0:O.en)||"",description_lang:(i==null?void 0:i.description_lang)||"",description_de:((q=i==null?void 0:i.description)==null?void 0:q[i==null?void 0:i.description_lang])||"",tag:t.tag,category_id:t.category_id,model_id:t.model_id,video_id:t.video_id,price:t.price,is_from_ftp:!1,thumbnail:"",video_file:"",is_terms:"",is_agreement:"",is_rules:"",seo:{h2:(j=t.seoDeatils)==null?void 0:j.h2,keyword:(L=t.seoDeatils)==null?void 0:L.keyword,meta_keyword:(Y=t.seoDeatils)==null?void 0:Y.meta_keyword,desc:(E=t.seoDeatils)==null?void 0:E.desc}}),[_,$]=g.exports.useState(""),[v,S]=g.exports.useState([]),[U,P]=g.exports.useState(!1),[te,Ce]=g.exports.useState(2),[le,D]=g.exports.useState(0),[k,z]=g.exports.useState(!1),[xe,se]=g.exports.useState([]);g.exports.useEffect(()=>{t&&((t==null?void 0:t.is_from_ftp)==1?(z(!0),r.is_from_ftp=!0):(t==null?void 0:t.is_from_ftp)==0&&(z(!1),r.is_from_ftp=!1)),se(t.category_id)},[]);const re=e=>{const n=e.target.value,o=t.title||{};b(c=>({...c,title_lang:n,title_de:o[n]||""}))},ne=e=>{const n=e.target.value,o=t.description||{};b(c=>({...c,description_lang:n,description_de:o[n]||""}))},ie=e=>{console.log(`selected ${e}`),$(e),r.video_file="short-videos/"+e,r.is_from_ftp=k},oe=e=>{console.log(`selected tag ${e}`),r.tag=e},ce=e=>{console.log(`selected category ${e}`),r.category_id=e},de=e=>{console.log(`selected model ${e}`),r.model_id=e},me=e=>{console.log(`selected video ${e}`),r.video_id=e};g.exports.useEffect(()=>{Object.keys(m).length&&Object.keys(m).map(e=>{C.error(m.key)})},[m]),g.exports.useEffect(()=>{v.length>0&&pe()},[v]);const h=e=>{const{name:n,type:o,checked:c,value:N}=e.target;n.startsWith("seo.")?b("seo",{...r.seo,[n.split(".")[1]]:o==="checkbox"?c:N}):b(n,o==="checkbox"?c:N)},he=()=>{S([]);let e=1024*1024*8,n=Math.ceil(_.size/e);for(let o=0;o<n;o++)S(c=>[...c,_.slice(o*e,Math.min(o*e+e,_.size),_.type)])},pe=()=>{P(!0);const e=new FormData;e.append("media_type","video"),e.append("from","short-videos"),e.append("is_last",v.length===1),e.append("video",te),e.set("file",v[0],`${_.name}.part`),we.post(route("video.uploadChunks"),e,{onUploadProgress:n=>{D(le+n.loaded)}}).then(function(n){v.length<=1&&(S([]),D(0),r.video_file=n.data.result,console.log(n.data.result),console.log("Chunks.length <= 1, posting data"),console.log(r),t.id===null?w.fire({title:"Are you sure?",text:"Do you want to save this preview?",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, save it!",cancelButtonText:"No, cancel"}).then(c=>{c.isConfirmed?(y(route("preview.save")),w.fire("Saved!","Your preview has been saved.","success")):c.dismiss===w.DismissReason.cancel&&w.fire("Cancelled","Your preview has not been saved","error")}):B());let o=[...v];o.splice(0,1),S(o)}).catch(function(n){var o,c;D(0),C.error((c=(o=n.response)==null?void 0:o.data)==null?void 0:c.message)}).then(function(){P(!1)})},ue=e=>{if(e.preventDefault(),!r.is_terms){C.error(s("Please agree to terms and conditions"));return}if(!r.is_agreement){C.error(s("Please agree to the agreement"));return}if(!r.is_rules){C.error(s("Please agree to the rules"));return}console.log(_,"videoFile"),_?k?(P(!0),t.id===null?w.fire({title:"Are you sure?",text:"Do you want to save this preview?",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, save it!",cancelButtonText:"No, cancel"}).then(n=>{n.isConfirmed?(y(route("preview.save")),w.fire("Saved!","Your preview has been saved.","success")):n.dismiss===w.DismissReason.cancel&&w.fire("Cancelled","Your preview has not been saved","error")}):(console.log("ggwp"),y(route("preview.update",{video:t.id}))),P(!1)):he():_===""&&t.id!==null&&(k?(console.log("gg"),y(route("preview.update",{video:t.id}))):B())},B=()=>{y(route("preview.update",{video:t.id}))};console.log(r,"data"),console.log(t,"video");const ge=ee.map(e=>{var c,N,K;const n=(c=e==null?void 0:e.label)==null?void 0:c.en,o=(K=(N=e==null?void 0:e.label)==null?void 0:N.ogValue)==null?void 0:K.title_lang;return{value:e==null?void 0:e.value,label:n||o||"Untitled Video"}});return l(fe,{children:[a(ve,{title:s("Upload Video")}),l("div",{className:"lg:flex lg:space-x-10",children:[a(Ne,{active:"upload-videos"}),l("div",{className:"p-4 sm:p-8 bg-white w-full dark:bg-zinc-900 shadow sm:rounded-lg",children:[l("header",{className:"mb-5",children:[l("h2",{className:"text-lg inline-flex items-center md:text-xl font-medium text-gray-600 dark:text-gray-100",children:[a(ke,{className:"mr-2"}),t.id===null?s("Upload Preview"):s("Edit Preview")]}),a("p",{className:"mt-1 mb-2 text-sm text-gray-600 dark:text-gray-400",children:s("Upload a new Preview")}),a(W,{onClick:e=>be.Inertia.visit(route("preview.list")),children:s("<< Back to Previews")})]}),a("hr",{className:"my-5"}),l("form",{onSubmit:ue,encType:"multipart/form-data",children:[l("div",{className:"mb-5",children:[a(d,{for:"title",value:s("Title")}),a(f,{name:"title_en_val",value:r.title_en_val,handleChange:h,required:!0,className:"mt-1 block w-full md:w-1/2"}),a(p,{message:m.title_en_val,className:"mt-2"})]}),l("div",{className:"mb-5",children:[a(d,{htmlFor:"title_lang",value:s("Select Title Language")}),l("select",{name:"title_lang",value:r.title_lang,onChange:re,className:"mt-1 block w-full md:w-1/2 ...",children:[a("option",{value:"",children:s("--Select--")}),u&&u.map(e=>a("option",{value:e.lang_value,children:e.lang_name},`title-locale-${e.lang_value}`))]})]}),r.title_lang&&l("div",{className:"mb-5",children:[a(d,{htmlFor:"title_de",value:`${((H=u==null?void 0:u.find(e=>e.lang_value===r.title_lang))==null?void 0:H.lang_name)||"Translated"} Title`}),a(f,{name:"title_de",value:r.title_de,handleChange:h,className:"mt-1 block w-full md:w-1/2"})]}),l("div",{className:"mb-5",children:[a(d,{for:"category",value:s("Category")}),a(x,{mode:"multiple",allowClear:!0,showSearch:!0,style:{width:"50%"},placeholder:"Please this  select",defaultValue:t.selectedCategory,onChange:ce,options:J,optionFilterProp:"label",filterOption:(e,n)=>n.label.toLowerCase().includes(e.toLowerCase())}),a(p,{message:m.category_id,className:"mt-2"})]}),l("div",{className:"mb-5",children:[a(d,{for:"model",value:s("Model")}),a(x,{mode:"multiple",allowClear:!0,showSearch:!0,style:{width:"50%"},placeholder:"Please select",defaultValue:t.model_id===null?[]:t.selectedModel,onChange:de,options:V,optionFilterProp:"label",filterOption:(e,n)=>n.label.toLowerCase().includes(e.toLowerCase())}),a(p,{message:m.model_id,className:"mt-2"})]}),l("div",{className:"mb-5",children:[a(d,{for:"tag",value:s("Tags")}),a(x,{mode:"multiple",allowClear:!0,showSearch:!0,style:{width:"50%"},placeholder:"Please select",defaultValue:t.tags===null?[]:t.selectedTags,onChange:oe,options:Z,optionFilterProp:"label",filterOption:(e,n)=>n.label.toLowerCase().includes(e.toLowerCase())}),a(p,{message:m.tag,className:"mt-2"})]}),l("div",{className:"mb-5",children:[a(d,{for:"model",value:s("Full Video Link")}),a(x,{allowClear:!0,showSearch:!0,style:{width:"50%"},placeholder:"Please select",defaultValue:t.video_id===null?[]:t.fullVideoLink,onChange:me,options:ge,optionFilterProp:"label",filterOption:(e,n)=>n.label.toLowerCase().includes(e.toLowerCase())}),a(p,{message:m.video_id,className:"mt-2"})]}),l("div",{className:"mb-5",children:[a(d,{for:"price",value:s("Price")}),l("div",{className:"flex items-center",children:[a(f,{type:"number",name:"price",value:r.price,handleChange:h,required:!0,className:"mt-1  w-32"}),l("div",{className:"ml-1 dark:text-white text-gray-700",children:[s("tokens")," ",s("0 = Free")]})]}),a(p,{message:m.price,className:"mt-2"})]}),l("div",{className:"mb-5",children:[a(d,{for:"thumbnail",value:s("Thumbnail - helps to attract sales (will be resized to 640x320px)")}),A&&a(G,{children:l("span",{className:"text-red-900",children:[" ",s("Upload only if you want to make a change")]})}),a(f,{className:"p-1 block w-full md:w-1/2 text-gray-900 border border-gray-300 rounded-lg cursor-pointer bg-gray-50 dark:text-gray-300 focus:outline-none dark:bg-zinc-800 dark:border-gray-600 dark:placeholder-zinc-900",type:"file",name:"thumbnail",handleChange:e=>b("thumbnail",e.target.files[0]),required:t.id===null}),a(p,{message:m.thumbnail,className:"mt-2"})]}),!k&&l("div",{className:"mb-5",children:[a(d,{for:"video",value:s("Video")}),A&&a(G,{children:l("span",{className:"text-red-900",children:[" ",s("Upload only if you want to make a change")]})}),a(f,{className:"p-1 block w-full md:w-1/2 text-gray-900 border border-gray-300 rounded-lg cursor-pointer bg-gray-50 dark:text-gray-300 focus:outline-none dark:bg-zinc-800 dark:border-gray-600 dark:placeholder-zinc-900",type:"file",name:"video",accept:"video/mp4,video/webm,video/ogg,video/quicktime,video/qt,video/mov",handleChange:e=>$(e.target.files[0]),required:t.id===null}),a(p,{message:m.video_file,className:"mt-2"})]}),k&&a("div",{className:"mt-2",children:a(x,{mode:"single",allowClear:!0,showSearch:!0,style:{width:"50%"},placeholder:"Please select",defaultValue:t.video,onChange:ie,options:X})}),l("div",{className:"mb-5",children:[a(d,{for:"description_en_val",value:s("Description")}),a(Q,{name:"description_en_val",value:r.description_en_val,handleChange:h,required:!0,className:"mt-1 block w-full md:w-1/2"}),a(p,{message:m.description_en_val,className:"mt-2"})]}),l("div",{className:"mb-5",children:[a(d,{htmlFor:"description_lang",value:s("Select Description Language")}),l("select",{name:"description_lang",value:r.description_lang,onChange:ne,className:"mt-1 block w-full md:w-1/2",children:[a("option",{value:"",children:s("--Select--")}),u&&u.map(e=>a("option",{value:e.lang_value,children:e.lang_name},`desc-locale-${e.lang_value}`))]})]}),r.description_lang&&l("div",{className:"mb-5",children:[a(d,{htmlFor:"description_de",value:`${(R=u==null?void 0:u.find(e=>e.lang_value===r.description_lang))==null?void 0:R.lang_name} ${s("Description")}`}),a(Q,{name:"description_de",value:r.description_de,handleChange:h,className:"mt-1 block w-full md:w-1/2"})]}),a("hr",{className:"mt-3"}),a("label",{children:"SEO"}),l("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l("div",{children:[a(d,{for:"seo_h2",value:"H2"}),a(f,{name:"seo.h2",value:r.seo.h2,handleChange:h,className:"mt-1 block w-full"})]}),l("div",{children:[a(d,{for:"seo_keyword",value:"Keyword"}),a(f,{name:"seo.keyword",value:r.seo.keyword,handleChange:h,className:"mt-1 block w-full"})]}),l("div",{children:[a(d,{for:"seo_meta_keyword",value:"Meta Keyword"}),a(f,{name:"seo.meta_keyword",value:r.seo.meta_keyword,handleChange:h,className:"mt-1 block w-full"})]}),l("div",{children:[a(d,{for:"seo_desc",value:"Meta Description"}),a(f,{name:"seo.desc",value:r.seo.desc,handleChange:h,className:"mt-1 block w-full"})]})]}),l("div",{className:"mt-4",children:[a(F,{name:"is_terms",checked:r.is_terms,handleChange:h}),l("span",{className:"mx-2",children:[s(" Agree to "),a("a",{href:"policy/Terms.pdf",className:"underline",target:"_blank",children:s("Terms and Conditions")})]}),a(p,{message:m.is_terms,className:"mt-2"})]}),l("div",{className:"mt-4",children:[a(F,{name:"is_agreement",checked:r.is_agreement,handleChange:h}),l("span",{className:"mx-2",children:[s(" Agree to "),a("a",{href:"policy/Streamer-Agreement.pdf",className:"underline",target:"_blank",children:s("Agreement")})]}),a(p,{message:m.is_agreement,className:"mt-2"})]}),l("div",{className:"mt-4",children:[a(F,{name:"is_rules",checked:r.is_rules,handleChange:h}),l("span",{className:"mx-2",children:[s(" Agree to "),a("a",{href:"policy/Content-Rules.pdf",className:"underline",target:"_blank",children:s("Rules")})]}),a(p,{message:m.is_rules,className:"mt-2"})]}),a("div",{className:"flex justify-between items-center mt-2",children:a(W,{processing:ae||U,children:t.id===null?s("Save Preview"):s("Update Preview")})}),U&&a("div",{className:"my-3",children:a(ye,{})}),T&&l("progress",{className:"mt-5",value:T.percentage,max:"100",children:[T.percentage,"%"]})]})]})]})]})}export{Ge as default};
