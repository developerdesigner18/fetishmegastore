import{I as o}from"./InputLabel.4e4122f6.js";import{I as f}from"./InputError.e1768fe1.js";import{T as u}from"./TextInput.618a5da3.js";import{T as K}from"./Textarea.8137cc1e.js";import{P as Q}from"./PrimaryButton.dc200cb7.js";import{_ as n}from"./Translate.dc83ae5b.js";import{Q as W}from"./react-toastify.esm.06aebf17.js";import{A as _e}from"./AuthenticatedLayout.fa68427b.js";import{i as ve,r as p,d as be,h as y,j as l,a as e,H as we}from"./app.64d592ef.js";import{S as Ne}from"./Spinner.507e754f.js";import{c as ke}from"./index.aca621cc.js";import Ce from"./AccountNavi.c0aead7d.js";import{S as _}from"./sweetalert2.esm.all.08ba7c87.js";import{S as x}from"./Front.fbff2f23.js";import{S as ye}from"./index.8849dce8.js";import"./index.6e860bb5.js";import"./iconBase.9b35345f.js";import"./index.6369b7cd.js";import"./react-cookie-consent.esm.c9f68579.js";import"./transition.cfd51e90.js";import"./Modal.81054d6f.js";import"./index.e7e076b2.js";import"./index.esm.7bfaeba6.js";function We({video:s,ogValue:r,categories:X,fileNames:Z,tags:V,models:ee,supportedLocales:k}){var j,O,L,P,F,M,B,$,q,E,Y,A,R,H,G,J;console.log("UploadVideo video",s);const{data:t,setData:b,post:z,processing:ae,errors:c,progress:S}=ve({title_en:((j=r==null?void 0:r.title)==null?void 0:j.en)||"",title_lang:(r==null?void 0:r.title_lang)||"",title_de:((O=r==null?void 0:r.title)==null?void 0:O[r==null?void 0:r.title_lang])||"",description_en:((L=r==null?void 0:r.description)==null?void 0:L.en)||"",description_lang:(r==null?void 0:r.description_lang)||"",description_de:((P=r==null?void 0:r.description)==null?void 0:P[r==null?void 0:r.description_lang])||"",tag:s.tag,category_id:s.category_id,model_id:s.model_id,price:s.price,free_for_subs:s.free_for_subs,is_from_ftp:!1,thumbnail:"",video_file:"",seo:{h2:(F=s.seoDeatils)==null?void 0:F.h2,keyword:(M=s.seoDeatils)==null?void 0:M.keyword,meta_keyword:(B=s.seoDeatils)==null?void 0:B.meta_keyword,desc:($=s.seoDeatils)==null?void 0:$.desc,og_title:(q=s.seoDeatils)==null?void 0:q.og_title,og_desc:(E=s.seoDeatils)==null?void 0:E.og_desc,meta_robot:(Y=s.seoDeatils)==null?void 0:Y.meta_robot,cust_url:(A=s.seoDeatils)==null?void 0:A.cust_url,og_image_url:(R=s.seoDeatils)==null?void 0:R.og_image_url,json_id:(H=s.seoDeatils)==null?void 0:H.json_id}}),[v,I]=p.exports.useState(""),[w,C]=p.exports.useState([]),[U,g]=p.exports.useState(!1),[se,xe]=p.exports.useState(2),[te,D]=p.exports.useState(0),[N,T]=p.exports.useState(!1),[Se,le]=p.exports.useState([]),ie=()=>{T(!N),t.is_from_ftp=N!==!0};p.exports.useEffect(()=>{s&&((s==null?void 0:s.is_from_ftp)==1?(T(!0),t.is_from_ftp=!0):(s==null?void 0:s.is_from_ftp)==0&&(T(!1),t.is_from_ftp=!1)),le(s.category_id)},[]);const re=a=>{console.log(`selected ${a}`),I(a),t.video_file="videos/"+a,t.is_from_ftp=N},oe=a=>{console.log(`selected tag ${a}`),t.tag=a},ne=a=>{console.log(`selected category ${a}`),t.category_id=a},de=a=>{console.log(`selected model ${a}`),t.model_id=a};p.exports.useEffect(()=>{w.length>0&&he()},[w]);const m=a=>{const{name:i,value:d}=a.target;if(b(i,d),i==="title_lang"){const h=s.title?JSON.parse(s.title):{};b("title_de",h[d]||"")}if(i==="description_lang"){const h=s.description?JSON.parse(s.description):{};b("description_de",h[d]||"")}},ce=a=>b({...t,title_lang:a.target.value,title_de:""}),me=a=>b({...t,description_lang:a.target.value,description_de:""});p.exports.useEffect(()=>{Object.keys(c).length&&Object.keys(c).forEach(a=>W.error(c[a]))},[c]);const ue=()=>{C([]);let a=1024*1024*8,i=Math.ceil(v.size/a);for(let d=0;d<i;d++)C(h=>[...h,v.slice(d*a,Math.min(d*a+a,v.size),v.type)])},he=()=>{g(!0);const a=new FormData;a.append("media_type","video"),a.append("is_last",w.length===1),a.append("video",se),a.set("file",w[0],`${v.name}.part`),be.post(route("video.uploadChunks"),a,{onUploadProgress:i=>{D(te+i.loaded)}}).then(function(i){w.length<=1&&(C([]),D(0),t.video_file=i.data.result,console.log(i.data.result),console.log("Chunks.length <= 1, posting data"),console.log(t),s.id===null?_.fire({title:"Are you sure?",text:"Do you want to save this video?",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, save it!",cancelButtonText:"No, cancel"}).then(h=>{h.isConfirmed?(z(route("videos.save")),_.fire("Saved!","Your video has been saved.","success")):h.dismiss===_.DismissReason.cancel&&_.fire("Cancelled","Your video has not been saved","error")}):pe());let d=[...w];d.splice(0,1),C(d)}).catch(function(i){var d,h;D(0),W.error((h=(d=i.response)==null?void 0:d.data)==null?void 0:h.message)}).then(function(){g(!1)})},fe=a=>{a.preventDefault(),v?N?(g(!0),s.id===null?_.fire({title:"Are you sure?",text:"Do you want to save this video?",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, save it!",cancelButtonText:"No, cancel"}).then(i=>{i.isConfirmed?(z(route("videos.save"),{onFinish:()=>g(!1)}),_.fire("Saved!","Your video has been saved.","success")):i.dismiss===_.DismissReason.cancel&&(g(!1),_.fire("Cancelled","Your video has not been saved","error"))}):y.Inertia.post(route("videos.update",{video:s.id}),{...t,_method:"PUT"},{onFinish:()=>g(!1)})):ue():v===""&&s.id!==null&&y.Inertia.post(route("videos.update",{video:s.id}),{...t,_method:"PUT"},{onFinish:()=>g(!1)})},pe=()=>{y.Inertia.post(route("videos.update",{video:s.id}),{...t,_method:"PUT"},{onFinish:()=>g(!1)})},ge=V.filter((a,i,d)=>i===d.findIndex(h=>h.value===a.value));return console.log("data",t),l(_e,{children:[e(we,{title:n("Upload Video")}),l("div",{className:"lg:flex lg:space-x-10",children:[e(Ce,{active:"upload-videos"}),l("div",{className:"p-4 sm:p-8 bg-white w-full dark:bg-zinc-900 shadow sm:rounded-lg",children:[l("header",{className:"mb-5",children:[l("h2",{className:"text-lg inline-flex items-center md:text-xl font-medium text-gray-600 dark:text-gray-100",children:[e(ke,{className:"mr-2"}),s.id===null?n("Upload Video"):n("Edit Video")]}),e("p",{className:"mt-1 mb-2 text-sm text-gray-600 dark:text-gray-400",children:n("Upload a new video")}),e(Q,{onClick:a=>y.Inertia.visit(route("videos.list")),children:n("<< Back to Videos")})]}),e("hr",{className:"my-5"}),l("form",{onSubmit:fe,encType:"multipart/form-data",children:[l("div",{className:"mb-5",children:[e(o,{for:"title",value:n("Title")}),e(u,{name:"title_en",value:t.title_en,handleChange:m,required:!0,className:"mt-1 block w-full md:w-1/2"}),e(f,{message:c.title_en,className:"mt-2"})]}),l("div",{className:"mb-5",children:[e(o,{for:"title_lang",value:n("Select Title Language")}),l("select",{name:"title_lang",value:t.title_lang,onChange:ce,className:"mt-1 block w-full md:w-1/2 border-zinc-300 dark:border-zinc-700 dark:bg-zinc-800 dark:text-gray-300 rounded-md shadow-sm",children:[e("option",{value:"",children:n("--Select--")}),k.map(a=>e("option",{value:a.lang_value,children:a.lang_name},a.lang_value))]}),e(f,{message:c.title_lang,className:"mt-2"})]}),l("div",{className:"mb-5",children:[e(o,{for:"title_de",value:`${(G=k.find(a=>a.lang_value===t.title_lang))==null?void 0:G.lang_name} Title`}),e(u,{name:"title_de",value:t.title_de,handleChange:m,required:!0,className:"mt-1 block w-full md:w-1/2"}),e(f,{message:c.title_de,className:"mt-2"})]}),l("div",{className:"mb-5",children:[e(o,{for:"category",value:n("Category")}),e(x,{mode:"multiple",allowClear:!0,showSearch:!0,style:{width:"50%"},placeholder:"Please select",defaultValue:s.category_id===""?[]:s.selectedCategory,onChange:ne,options:X,filterOption:(a,i)=>i.label.toLowerCase().includes(a.toLowerCase())}),e(f,{message:c.category_id,className:"mt-2"})]}),l("div",{className:"mb-5",children:[e(o,{for:"model",value:n("Model")}),e(x,{mode:"multiple",allowClear:!0,showSearch:!0,style:{width:"50%"},placeholder:"Please select",defaultValue:s.model_id===null?[]:s.selectedModel,onChange:de,options:ee,filterOption:(a,i)=>i.label.toLowerCase().includes(a.toLowerCase())}),e(f,{message:c.model_id,className:"mt-2"})]}),l("div",{className:"mb-5",children:[e(o,{for:"tag",value:n("Tags")}),e(x,{mode:"multiple",allowClear:!0,showSearch:!0,style:{width:"50%"},placeholder:"Please select",defaultValue:s.tags===null?[]:s.selectedTags,onChange:oe,options:ge,filterOption:(a,i)=>{var d;return(d=i==null?void 0:i.label)==null?void 0:d.toLowerCase().includes(a.toLowerCase())}}),e(f,{message:c.tag,className:"mt-2"})]}),l("div",{className:"flex w-full md:w-1/2 flex-col md:flex-row md:items-center md:space-x-10 md:justify-between",children:[l("div",{className:"mb-5",children:[e(o,{for:"price",value:n("Price")}),l("div",{className:"flex items-center",children:[e(u,{type:"number",name:"price",value:t.price,handleChange:m,required:!0,className:"mt-1  w-32"}),e("div",{className:"ml-1 dark:text-white text-gray-700",children:n("tokens")})]}),e(f,{message:c.price,className:"mt-2"})]}),l("div",{className:"mb-5",children:[e(o,{for:"free_for_subs",value:n("Free for subscribers?")}),l("select",{name:"free_for_subs",value:t.free_for_subs,onChange:m,required:!0,className:"mt-1 block w-32 border-zinc-300 dark:border-zinc-700 dark:bg-zinc-800 dark:text-gray-300 focus:border-indigo-500 dark:focus:border-indigo-600 focus:ring-indigo-500 dark:focus:ring-indigo-600 rounded-md shadow-sm ",children:[e("option",{value:"yes",children:n("Yes")}),e("option",{value:"no",children:n("No")})]}),e(f,{message:c.free_for_subs,className:"mt-2"})]})]}),l("div",{className:"mb-5",children:[e(o,{for:"thumbnail",value:n("Thumbnail - helps to attract sales (will be resized to 640x320px)")}),e(u,{className:"p-1 block w-full md:w-1/2 text-gray-900 border border-gray-300 rounded-lg cursor-pointer bg-gray-50 dark:text-gray-300 focus:outline-none dark:bg-zinc-800 dark:border-gray-600 dark:placeholder-zinc-900",type:"file",name:"thumbnail",handleChange:a=>b("thumbnail",a.target.files[0])}),e(f,{message:c.thumbnail,className:"mt-2"})]}),e("div",{children:l("label",{children:[e(ye,{onChange:ie,checked:t.is_from_ftp}),"Select video from ftp?"]})}),!N&&l("div",{className:"mb-5",children:[e(o,{for:"video",value:n("Video")}),e(o,{for:"video",value:"Video File"}),e(u,{type:"file",name:"video",accept:"video/*",handleChange:a=>I(a.target.files[0])}),e(f,{message:c.video_file})]}),N&&e("div",{className:"mt-2",children:e(x,{mode:"single",allowClear:!0,showSearch:!0,style:{width:"50%"},placeholder:"Please select",defaultValue:s.video,onChange:re,options:Z})}),l("div",{className:"mb-5",children:[e(o,{for:"description_en",value:n("Description")}),e(K,{name:"description_en",value:t.description_en,handleChange:m,required:!0,className:"mt-1 block w-full md:w-1/2"}),e(f,{message:c.description_en,className:"mt-2"})]}),l("div",{className:"mb-5",children:[e(o,{for:"description_lang",value:n("Select Description Language")}),l("select",{name:"description_lang",value:t.description_lang,onChange:me,className:"mt-1 block w-full md:w-1/2 border-zinc-300 dark:border-zinc-700 dark:bg-zinc-800 dark:text-gray-300 rounded-md shadow-sm",children:[e("option",{value:"",children:n("--Select--")}),k.map(a=>e("option",{value:a.lang_value,children:a.lang_name},a.lang_value))]}),e(f,{message:c.description_lang,className:"mt-2"})]}),l("div",{className:"mb-5",children:[e(o,{for:"description_de",value:`${(J=k.find(a=>a.lang_value===t.description_lang))==null?void 0:J.lang_name} ${n("Description")}`}),e(K,{name:"description_de",value:t.description_de,handleChange:m,required:!0,className:"mt-1 block w-full md:w-1/2"}),e(f,{message:c.description_de,className:"mt-2"})]}),e("hr",{className:"mt-3"}),e("label",{children:"SEO"}),l("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l("div",{children:[e(o,{for:"seo_h2",value:"H2"}),e(u,{name:"seo.h2",value:t.seo.h2,handleChange:m,className:"mt-1 block w-full"})]}),l("div",{children:[e(o,{for:"seo_keyword",value:"Keyword"}),e(u,{name:"seo.keyword",value:t.seo.keyword,handleChange:m,className:"mt-1 block w-full"})]}),l("div",{children:[e(o,{for:"seo_meta_keyword",value:"Meta Keyword"}),e(u,{name:"seo.meta_keyword",value:t.seo.meta_keyword,handleChange:m,className:"mt-1 block w-full"})]}),l("div",{children:[e(o,{for:"seo_desc",value:"Meta Description"}),e(u,{name:"seo.desc",value:t.seo.desc,handleChange:m,className:"mt-1 block w-full"})]}),l("div",{children:[e(o,{for:"seo_og_title",value:"OG Title"}),e(u,{name:"seo.og_title",value:t.seo.og_title,handleChange:m,className:"mt-1 block w-full"})]}),l("div",{children:[e(o,{for:"seo_og_desc",value:"OG Description"}),e(u,{name:"seo.og_desc",value:t.seo.og_desc,handleChange:m,className:"mt-1 block w-full"})]}),l("div",{children:[e(o,{for:"seo_meta_robot",value:"Meta Robot"}),e(u,{name:"seo.meta_robot",value:t.seo.meta_robot,handleChange:m,className:"mt-1 block w-full"})]}),l("div",{children:[e(o,{for:"seo_cust_url",value:"Custom URL"}),e(u,{name:"seo.cust_url",value:t.seo.cust_url,handleChange:m,className:"mt-1 block w-full"})]}),l("div",{children:[e(o,{for:"seo_og_image_url",value:"OG Image URL"}),e(u,{name:"seo.og_image_url",value:t.seo.og_image_url,handleChange:m,className:"mt-1 block w-full"})]}),l("div",{children:[e(o,{for:"seo_json_id",value:"JSON ID"}),e(u,{name:"seo.json_id",value:t.seo.json_id,handleChange:m,className:"mt-1 block w-full"})]})]}),e("div",{className:"flex justify-between items-center mt-2",children:e(Q,{processing:ae||U,children:s.id===null?n("Save Video"):n("Update Video")})}),U&&e("div",{className:"my-3",children:e(Ne,{})}),S&&l("progress",{className:"mt-5",value:S.percentage,max:"100",children:[S.percentage,"%"]})]})]})]})]})}export{We as default};
